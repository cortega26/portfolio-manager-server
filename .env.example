# ===========================================
# Portfolio Manager - Environment Variables
# ===========================================
# Copy this file to .env and customize values for your environment.
# Values shown below are safe development defaults.

# --- Server Configuration ---
NODE_ENV=development
PORT=3000
# Accepted values: trace, debug, info, warn, error, fatal, silent
LOG_LEVEL=info

# --- Data Storage ---
# Relative or absolute path where portfolio JSON files are stored.
DATA_DIR=./data

# --- Security & Access Control ---
# Comma-separated list of exact origins allowed to call the API in production.
CORS_ALLOWED_ORIGINS=http://localhost:5173,http://localhost:4173
# Toggle cash accrual and blended benchmark endpoints.
FEATURES_CASH_BENCHMARKS=true
# Maximum invalid attempts before lockout (per portfolio + IP).
BRUTE_FORCE_MAX_ATTEMPTS=5
# Sliding window in seconds tracking failed attempts.
BRUTE_FORCE_ATTEMPT_WINDOW_SECONDS=900
# Initial lockout duration (seconds) once threshold reached.
BRUTE_FORCE_LOCKOUT_SECONDS=900
# Ceiling on lockout duration (seconds).
BRUTE_FORCE_MAX_LOCKOUT_SECONDS=3600
# Progressive multiplier applied to each subsequent lockout duration.
BRUTE_FORCE_LOCKOUT_MULTIPLIER=2
# Internal check interval for brute-force caches.
BRUTE_FORCE_CHECK_PERIOD=60
# Maximum number of security audit events kept in the in-memory buffer.
SECURITY_AUDIT_MAX_EVENTS=200
# Request-level limits (per minute by default) for general, portfolio, and price endpoints.
RATE_LIMIT_GENERAL_WINDOW_MS=60000
RATE_LIMIT_GENERAL_MAX=100
RATE_LIMIT_PORTFOLIO_WINDOW_MS=60000
RATE_LIMIT_PORTFOLIO_MAX=20
RATE_LIMIT_PRICES_WINDOW_MS=60000
RATE_LIMIT_PRICES_MAX=60

# --- Background Jobs ---
# UTC hour (0-23) when the nightly close process runs.
JOB_NIGHTLY_HOUR=4

# --- Performance & Timeouts ---
# Private cache lifetime (seconds) applied to NAV/returns responses.
API_CACHE_TTL_SECONDS=600
# In-memory TTL for price responses served by /api/prices (seconds).
PRICE_CACHE_TTL_SECONDS=600
# Interval in seconds for the price cache sweeping expired entries.
PRICE_CACHE_CHECK_PERIOD=120
# Upstream price fetch timeout in milliseconds.
PRICE_FETCH_TIMEOUT_MS=5000
# Maximum trading-day age permitted for benchmark data before returning 503.
FRESHNESS_MAX_STALE_TRADING_DAYS=3

# --- Frontend Overrides ---
# Change this when the Vite frontend should target a non-local API.
VITE_API_BASE=http://localhost:3000
