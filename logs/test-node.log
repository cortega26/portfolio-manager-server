
> portfolio-manager-server@1.0.0 test:node
> node --enable-source-maps tools/run-tests.mjs


[test-run 1/1] seed=20251006 fileCount=46
  1. src\__tests__\useDebouncedValue.test.js
  2. server\__tests__\cache_behaviors.test.js
  3. src\__tests__\reports.test.js
  4. server\__tests__\api_validation.test.js
  5. server\__tests__\csv_sanitize.test.js
  6. server\__tests__\api_cache.test.js
  7. src\__tests__\holdings_ledger.test.js
  8. server\__tests__\daily_close.test.js
  9. server\__tests__\prices.test.js
  10. server\__tests__\security_events.test.js
  11. server\__tests__\returns.property.test.js
  12. server\__tests__\compression.test.js
  13. src\__tests__\portfolioStore.test.js
  14. server\__tests__\edge_cases.test.js
  15. server\__tests__\migrations_portfolio_cash_policy.test.js
  16. server\__tests__\priceCache.test.js
  17. server\__tests__\returns.mutation.test.js
  18. server\__tests__\bruteForce.test.js
  19. src\__tests__\roi.test.js
  20. src\__tests__\holdings.test.js
  21. src\__tests__\history.utils.test.js
  22. server\__tests__\returns.test.js
  23. server\__tests__\audit_log.test.js
  24. server\__tests__\portfolio_finance.test.js
  25. server\__tests__\cash.property.test.js
  26. server\__tests__\api_contract.test.js
  27. src\__tests__\format.test.js
  28. server\__tests__\holdings.test.js
  29. server\__tests__\rate_limit_monitoring.test.js
  30. src\__tests__\portfolioSchema.test.js
  31. server\__tests__\integration.test.js
  32. server\__tests__\cash.test.js
  33. server\__tests__\events_store.test.js
  34. server\__tests__\freshness_guard.test.js
  35. server\__tests__\monitoring_endpoint.test.js
  36. src\__tests__\roi.property.test.js
  37. server\__tests__\http_logging_redaction.test.js
  38. server\__tests__\portfolio_keys.test.js
  39. server\__tests__\calendar.test.js
  40. server\__tests__\decimal.test.js
  41. server\__tests__\storage_concurrency.test.js
  42. server\__tests__\api_errors.test.js
  43. shared\__tests__\apiKey.test.js
  44. server\__tests__\returns.snapshot.test.js
  45. server\__tests__\ledger.property.test.js
  46. server\__tests__\portfolio.test.js
{"level":30,"time":1763149550319,"pid":6436,"hostname":"i5-12600","req":{"id":"a48ecf1e-e0cf-4772-873f-877a44cbc34b","method":"GET","url":"/api/prices/AAPL?range=1y","query":{"range":"1y"},"params":{},"headers":{"host":"127.0.0.1:31565","accept-encoding":"gzip, deflate","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":31566},"res":{"statusCode":200,"headers":{"x-request-id":"a48ecf1e-e0cf-4772-873f-877a44cbc34b","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"60;w=60","ratelimit-limit":"60","ratelimit-remaining":"59","ratelimit-reset":"60","etag":"21399a56f73049ff48f3745e0d3c00d5","cache-control":"private, max-age=600","x-cache":"MISS","content-type":"application/json; charset=utf-8","content-length":"69"}},"responseTime":29,"msg":"request_complete"}
{"level":30,"time":1763149550333,"pid":6436,"hostname":"i5-12600","req":{"id":"573a61bb-5828-4613-9373-7a59635a06c6","method":"GET","url":"/api/prices/AAPL?range=1y","query":{"range":"1y"},"params":{},"headers":{"host":"127.0.0.1:31567","accept-encoding":"gzip, deflate","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":31568},"res":{"statusCode":200,"headers":{"x-request-id":"573a61bb-5828-4613-9373-7a59635a06c6","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"60;w=60","ratelimit-limit":"60","ratelimit-remaining":"58","ratelimit-reset":"60","etag":"21399a56f73049ff48f3745e0d3c00d5","cache-control":"private, max-age=600","x-cache":"HIT","content-type":"application/json; charset=utf-8","content-length":"69"}},"responseTime":2,"msg":"request_complete"}
✔ returns cached price on subsequent requests (85.2421ms)
{"level":30,"time":1763149550346,"pid":6436,"hostname":"i5-12600","req":{"id":"68a0c040-e98d-4260-a519-dc3855b10c24","method":"GET","url":"/api/prices/AAPL?range=1y","query":{"range":"1y"},"params":{},"headers":{"host":"127.0.0.1:31569","accept-encoding":"gzip, deflate","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":31570},"res":{"statusCode":200,"headers":{"x-request-id":"68a0c040-e98d-4260-a519-dc3855b10c24","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"60;w=60","ratelimit-limit":"60","ratelimit-remaining":"59","ratelimit-reset":"60","etag":"21399a56f73049ff48f3745e0d3c00d5","cache-control":"private, max-age=600","x-cache":"MISS","content-type":"application/json; charset=utf-8","content-length":"69"}},"responseTime":2,"msg":"request_complete"}
{"level":30,"time":1763149550354,"pid":6436,"hostname":"i5-12600","req":{"id":"0fd3f5b7-1bca-4573-b8a4-9c76c6451b3a","method":"GET","url":"/api/prices/AAPL?range=1y","query":{"range":"1y"},"params":{},"headers":{"host":"127.0.0.1:31571","accept-encoding":"gzip, deflate","if-none-match":"21399a56f73049ff48f3745e0d3c00d5","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":31572},"res":{"statusCode":304,"headers":{"x-request-id":"0fd3f5b7-1bca-4573-b8a4-9c76c6451b3a","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin","ratelimit-policy":"60;w=60","ratelimit-limit":"60","ratelimit-remaining":"58","ratelimit-reset":"60","etag":"21399a56f73049ff48f3745e0d3c00d5","cache-control":"private, max-age=600","x-cache":"HIT"}},"responseTime":3,"msg":"request_complete"}
✔ supports conditional requests with ETag (20.0775ms)
{"level":30,"time":1763149550369,"pid":6436,"hostname":"i5-12600","req":{"id":"f326f0fb-54ab-4d67-9326-b628c39eea7b","method":"GET","url":"/api/prices/AAPL?range=1y","query":{"range":"1y"},"params":{},"headers":{"host":"127.0.0.1:31573","accept-encoding":"gzip, deflate","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":31574},"res":{"statusCode":200,"headers":{"x-request-id":"f326f0fb-54ab-4d67-9326-b628c39eea7b","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"60;w=60","ratelimit-limit":"60","ratelimit-remaining":"59","ratelimit-reset":"60","etag":"21399a56f73049ff48f3745e0d3c00d5","cache-control":"private, max-age=600","x-cache":"MISS","content-type":"application/json; charset=utf-8","content-length":"69"}},"responseTime":2,"msg":"request_complete"}
{"level":30,"time":1763149550385,"pid":6436,"hostname":"i5-12600","req":{"id":"04cef0fb-9a92-4148-8c75-6d378a600faa","method":"GET","url":"/api/cache/stats","query":{},"params":{},"headers":{"host":"127.0.0.1:31575","accept-encoding":"gzip, deflate","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":31576},"res":{"statusCode":200,"headers":{"x-request-id":"04cef0fb-9a92-4148-8c75-6d378a600faa","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"100;w=60","ratelimit-limit":"100","ratelimit-remaining":"98","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"42","etag":"W/\"2a-mmMD8MlgI8mC1gC2v4xMFeT3xCk\""}},"responseTime":4,"msg":"request_complete"}
✔ exposes cache stats endpoint (34.4354ms)
{"level":30,"time":1763149551699,"pid":22924,"hostname":"i5-12600","req":{"id":"4044990f-90ad-495c-a74e-5ef0823e2c2c","method":"GET","url":"/api/returns/daily?from=2024-01-01&to=2024-01-02&views=port,excash,spy,bench","query":{"from":"2024-01-01","to":"2024-01-02","views":"port,excash,spy,bench"},"params":{},"headers":{"host":"127.0.0.1:47937","accept-encoding":"gzip, deflate","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47938},"res":{"statusCode":200,"headers":{"x-request-id":"4044990f-90ad-495c-a74e-5ef0823e2c2c","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"19","ratelimit-reset":"60","cache-control":"private, max-age=600","etag":"eBpgGgaTfCVkusqoYoEzAX82XcBKyQG3Ddp13uxmJEE","content-type":"application/json; charset=utf-8","content-length":"502"}},"responseTime":215,"msg":"request_complete"}
✔ GET /api/returns/daily matches the OpenAPI contract (512.1935ms)
{"level":30,"time":1763149552072,"pid":22924,"hostname":"i5-12600","req":{"id":"5fbd9251-7b1c-4001-bfc7-a46f7c40b6e4","method":"GET","url":"/api/v1/returns/daily?from=2024-01-01&to=2024-01-02&views=port,excash,spy,bench","query":{"from":"2024-01-01","to":"2024-01-02","views":"port,excash,spy,bench"},"params":{},"headers":{"host":"127.0.0.1:47967","accept-encoding":"gzip, deflate","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47968},"res":{"statusCode":200,"headers":{"x-request-id":"5fbd9251-7b1c-4001-bfc7-a46f7c40b6e4","x-api-version":"v1","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"19","ratelimit-reset":"60","cache-control":"private, max-age=600","etag":"eBpgGgaTfCVkusqoYoEzAX82XcBKyQG3Ddp13uxmJEE","content-type":"application/json; charset=utf-8","content-length":"502"}},"responseTime":159,"msg":"request_complete"}
✔ GET /api/v1/returns/daily matches the OpenAPI contract (302.6738ms)
{"level":30,"time":1763149552199,"pid":22924,"hostname":"i5-12600","req":{"id":"89f39ac7-4a9b-4aa0-ab15-da723a6f4603","method":"GET","url":"/api/prices/bulk?symbols=AAPL,MSFT&range=1y","query":{"symbols":"AAPL,MSFT","range":"1y"},"params":{},"headers":{"host":"127.0.0.1:47989","accept-encoding":"gzip, deflate","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47990},"res":{"statusCode":200,"headers":{"x-request-id":"89f39ac7-4a9b-4aa0-ab15-da723a6f4603","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"60;w=60","ratelimit-limit":"60","ratelimit-remaining":"59","ratelimit-reset":"60","etag":"a3309c4f906cb9b4694a086f9a28162b","cache-control":"private, max-age=600","x-cache":"MISS","content-type":"application/json; charset=utf-8","content-length":"75"}},"responseTime":12,"msg":"request_complete"}
✖ GET /api/prices/bulk returns multiple price series (116.8311ms)
{"level":30,"time":1763149552307,"pid":22924,"hostname":"i5-12600","req":{"id":"10a1731d-fae6-43c9-a30f-d2edab49eb8a","method":"GET","url":"/api/v1/prices/bulk?symbols=AAPL,MSFT&range=1y","query":{"symbols":"AAPL,MSFT","range":"1y"},"params":{},"headers":{"host":"127.0.0.1:47993","accept-encoding":"gzip, deflate","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47995},"res":{"statusCode":200,"headers":{"x-request-id":"10a1731d-fae6-43c9-a30f-d2edab49eb8a","x-api-version":"v1","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"60;w=60","ratelimit-limit":"60","ratelimit-remaining":"59","ratelimit-reset":"60","etag":"a3309c4f906cb9b4694a086f9a28162b","cache-control":"private, max-age=600","x-cache":"MISS","content-type":"application/json; charset=utf-8","content-length":"75"}},"responseTime":2,"msg":"request_complete"}
✖ GET /api/v1/prices/bulk returns multiple price series (100.0293ms)
{"level":30,"time":1763149552589,"pid":22924,"hostname":"i5-12600","req":{"id":"fd8974dc-3465-440c-94b0-2490c1e3ef4e","method":"GET","url":"/api/nav/daily?from=2024-01-01&to=2024-01-02","query":{"from":"2024-01-01","to":"2024-01-02"},"params":{},"headers":{"host":"127.0.0.1:48004","accept-encoding":"gzip, deflate","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48005},"res":{"statusCode":200,"headers":{"x-request-id":"fd8974dc-3465-440c-94b0-2490c1e3ef4e","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"19","ratelimit-reset":"60","cache-control":"private, max-age=600","etag":"snKB9KFXcsZcDpx6N9lJnu5osFWD39pevEXDvIL2F2U","content-type":"application/json; charset=utf-8","content-length":"396"}},"responseTime":162,"msg":"request_complete"}
✔ GET /api/nav/daily matches the OpenAPI contract (292.574ms)
{"level":30,"time":1763149552869,"pid":22924,"hostname":"i5-12600","req":{"id":"6df8ef44-cff7-42d9-8e92-10b4bbc7a5ea","method":"GET","url":"/api/v1/nav/daily?from=2024-01-01&to=2024-01-02","query":{"from":"2024-01-01","to":"2024-01-02"},"params":{},"headers":{"host":"127.0.0.1:48041","accept-encoding":"gzip, deflate","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48042},"res":{"statusCode":200,"headers":{"x-request-id":"6df8ef44-cff7-42d9-8e92-10b4bbc7a5ea","x-api-version":"v1","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"19","ratelimit-reset":"60","cache-control":"private, max-age=600","etag":"snKB9KFXcsZcDpx6N9lJnu5osFWD39pevEXDvIL2F2U","content-type":"application/json; charset=utf-8","content-length":"396"}},"responseTime":163,"msg":"request_complete"}
✔ GET /api/v1/nav/daily matches the OpenAPI contract (278.141ms)
{"level":30,"time":1763149553243,"pid":22924,"hostname":"i5-12600","req":{"id":"0fbb8d15-f77b-4120-9fd6-3767df014705","method":"GET","url":"/api/benchmarks/summary?from=2024-01-01&to=2024-01-02","query":{"from":"2024-01-01","to":"2024-01-02"},"params":{},"headers":{"host":"127.0.0.1:48051","accept-encoding":"gzip, deflate","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48052},"res":{"statusCode":200,"headers":{"x-request-id":"0fbb8d15-f77b-4120-9fd6-3767df014705","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"100;w=60","ratelimit-limit":"100","ratelimit-remaining":"99","ratelimit-reset":"60","cache-control":"private, max-age=600","etag":"H6R946bBxGHSAgpySydzkRWAmlAv7W5msd-kYSnzzQc","content-type":"application/json; charset=utf-8","content-length":"265"}},"responseTime":231,"msg":"request_complete"}
✔ GET /api/benchmarks/summary matches the OpenAPI contract (376.5921ms)
{"level":30,"time":1763149553683,"pid":22924,"hostname":"i5-12600","req":{"id":"19c0db04-4152-4836-8834-782fc624906b","method":"GET","url":"/api/v1/benchmarks/summary?from=2024-01-01&to=2024-01-02","query":{"from":"2024-01-01","to":"2024-01-02"},"params":{},"headers":{"host":"127.0.0.1:48075","accept-encoding":"gzip, deflate","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48076},"res":{"statusCode":200,"headers":{"x-request-id":"19c0db04-4152-4836-8834-782fc624906b","x-api-version":"v1","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"100;w=60","ratelimit-limit":"100","ratelimit-remaining":"99","ratelimit-reset":"60","cache-control":"private, max-age=600","etag":"H6R946bBxGHSAgpySydzkRWAmlAv7W5msd-kYSnzzQc","content-type":"application/json; charset=utf-8","content-length":"265"}},"responseTime":253,"msg":"request_complete"}
✔ GET /api/v1/benchmarks/summary matches the OpenAPI contract (440.9523ms)
{"level":30,"time":1763149553779,"pid":22924,"hostname":"i5-12600","req":{"id":"58a4fe54-2f31-43c6-a321-3f8ad4e4b7a0","method":"GET","url":"/api/prices/AAPL","query":{},"params":{},"headers":{"host":"127.0.0.1:48097","accept-encoding":"gzip, deflate","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48098},"res":{"statusCode":200,"headers":{"x-request-id":"58a4fe54-2f31-43c6-a321-3f8ad4e4b7a0","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"60;w=60","ratelimit-limit":"60","ratelimit-remaining":"59","ratelimit-reset":"60","etag":"a3309c4f906cb9b4694a086f9a28162b","cache-control":"private, max-age=600","x-cache":"MISS","content-type":"application/json; charset=utf-8","content-length":"75"}},"responseTime":1,"msg":"request_complete"}
✔ GET /api/prices/:symbol matches the OpenAPI contract (84.1001ms)
{"level":30,"time":1763149553891,"pid":22924,"hostname":"i5-12600","req":{"id":"cc1ce886-9d3c-4d66-b98d-9380daea23bc","method":"GET","url":"/api/v1/prices/AAPL","query":{},"params":{},"headers":{"host":"127.0.0.1:48099","accept-encoding":"gzip, deflate","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48100},"res":{"statusCode":200,"headers":{"x-request-id":"cc1ce886-9d3c-4d66-b98d-9380daea23bc","x-api-version":"v1","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"60;w=60","ratelimit-limit":"60","ratelimit-remaining":"59","ratelimit-reset":"60","etag":"a3309c4f906cb9b4694a086f9a28162b","cache-control":"private, max-age=600","x-cache":"MISS","content-type":"application/json; charset=utf-8","content-length":"75"}},"responseTime":2,"msg":"request_complete"}
✔ GET /api/v1/prices/:symbol matches the OpenAPI contract (111.6898ms)
{"level":40,"time":1763149550810,"pid":16496,"hostname":"i5-12600","req":{"id":"3aa303a3-7d9d-476c-b8ef-7249a57b8fb3","method":"GET","url":"/api/portfolio/invalid%20id%20with%20spaces","query":{},"params":{},"headers":{"host":"127.0.0.1:31577","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":31578},"error":"Request validation failed.","code":"VALIDATION_ERROR","status":400,"msg":"request_error"}
{"level":30,"time":1763149550816,"pid":16496,"hostname":"i5-12600","req":{"id":"3aa303a3-7d9d-476c-b8ef-7249a57b8fb3","method":"GET","url":"/api/portfolio/invalid%20id%20with%20spaces","query":{},"params":{},"headers":{"host":"127.0.0.1:31577","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":31578},"res":{"statusCode":400,"headers":{"x-request-id":"3aa303a3-7d9d-476c-b8ef-7249a57b8fb3","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"19","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"171","etag":"W/\"ab-ikk385Y8IPqL+aRqO+g8dBr2zqY\""}},"responseTime":24,"msg":"request_complete"}
✔ returns 400 for invalid portfolio identifier formatting (72.0591ms)
{"level":40,"time":1763149550871,"pid":16496,"hostname":"i5-12600","req":{"id":"3ed10004-7026-4913-9c31-9f6f77029586","method":"POST","url":"/api/portfolio/badjson","query":{},"params":{},"headers":{"host":"127.0.0.1:31581","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","content-type":"application/json","content-length":"16","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":31582},"error":"Invalid JSON payload.","code":"INVALID_JSON","status":400,"msg":"request_error"}
{"level":30,"time":1763149550872,"pid":16496,"hostname":"i5-12600","req":{"id":"3ed10004-7026-4913-9c31-9f6f77029586","method":"POST","url":"/api/portfolio/badjson","query":{},"params":{},"headers":{"host":"127.0.0.1:31581","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","content-type":"application/json","content-length":"16","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":31582},"res":{"statusCode":400,"headers":{"x-request-id":"3ed10004-7026-4913-9c31-9f6f77029586","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","content-type":"application/json; charset=utf-8","content-length":"58","etag":"W/\"3a-Wq00HHtAg+6zoSI+mSSSIJSk0Ok\""}},"responseTime":38,"msg":"request_complete"}
✔ returns 400 when JSON payload is malformed (49.2776ms)
{"level":30,"time":1763149551162,"pid":16496,"hostname":"i5-12600","req":{"id":"83160fef-474d-40d0-9f17-b6186b9e24c8","method":"POST","url":"/api/portfolio/weak-key-test","query":{},"params":{},"headers":{"host":"127.0.0.1:47895","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","content-type":"application/json","content-length":"19","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47896},"component":"security_audit","event_type":"security","event":"weak_key_rejected","timestamp":"2025-11-14T19:45:51.161Z","request_id":"83160fef-474d-40d0-9f17-b6186b9e24c8","ip":"::ffff:127.0.0.1","portfolio_id":"weak-key-test","action":"bootstrap","issues":["API key must be at least 12 characters long","API key does not meet strength requirements"]}
{"level":40,"time":1763149551162,"pid":16496,"hostname":"i5-12600","req":{"id":"83160fef-474d-40d0-9f17-b6186b9e24c8","method":"POST","url":"/api/portfolio/weak-key-test","query":{},"params":{},"headers":{"host":"127.0.0.1:47895","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","content-type":"application/json","content-length":"19","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47896},"error":"API key does not meet strength requirements","code":"WEAK_KEY","status":400,"msg":"request_error"}
{"level":30,"time":1763149551163,"pid":16496,"hostname":"i5-12600","req":{"id":"83160fef-474d-40d0-9f17-b6186b9e24c8","method":"POST","url":"/api/portfolio/weak-key-test","query":{},"params":{},"headers":{"host":"127.0.0.1:47895","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","content-type":"application/json","content-length":"19","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47896},"res":{"statusCode":400,"headers":{"x-request-id":"83160fef-474d-40d0-9f17-b6186b9e24c8","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"19","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"240","etag":"W/\"f0-HZLyOFjtQDbqkIieMMP8l2UThCE\""}},"responseTime":276,"msg":"request_complete"}
✔ returns 400 when attempting to bootstrap with a weak key (304.5212ms)
{"level":40,"time":1763149551260,"pid":16496,"hostname":"i5-12600","req":{"id":"748949f4-b02b-4734-a7ca-c1b8310da45f","method":"POST","url":"/api/portfolio/oversized","query":{},"params":{},"headers":{"host":"127.0.0.1:47907","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","content-type":"application/json","content-length":"11534417","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47912},"error":"Request payload too large.","code":"PAYLOAD_TOO_LARGE","status":413,"msg":"request_error"}
{"level":30,"time":1763149551261,"pid":16496,"hostname":"i5-12600","req":{"id":"748949f4-b02b-4734-a7ca-c1b8310da45f","method":"POST","url":"/api/portfolio/oversized","query":{},"params":{},"headers":{"host":"127.0.0.1:47907","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","content-type":"application/json","content-length":"11534417","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47912},"res":{"statusCode":413,"headers":{"x-request-id":"748949f4-b02b-4734-a7ca-c1b8310da45f","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","content-type":"application/json; charset=utf-8","content-length":"68","etag":"W/\"44-2ZzJilW5NgIgsQgbe1VgRY1LFYM\""}},"responseTime":26,"msg":"request_complete"}
✔ returns 413 for payloads larger than the JSON body limit (84.1752ms)
{"level":40,"time":1763149551557,"pid":16496,"hostname":"i5-12600","req":{"id":"72af5549-984c-4524-ab4e-0285b4005d9e","method":"GET","url":"/api/portfolio/missing","query":{},"params":{},"headers":{"host":"127.0.0.1:47921","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47922},"error":"Portfolio not provisioned.","code":"PORTFOLIO_NOT_FOUND","status":404,"msg":"request_error"}
{"level":30,"time":1763149551558,"pid":16496,"hostname":"i5-12600","req":{"id":"72af5549-984c-4524-ab4e-0285b4005d9e","method":"GET","url":"/api/portfolio/missing","query":{},"params":{},"headers":{"host":"127.0.0.1:47921","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47922},"res":{"statusCode":404,"headers":{"x-request-id":"72af5549-984c-4524-ab4e-0285b4005d9e","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"19","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"70","etag":"W/\"46-ncIydHaYNOkeDN1W0L5/KQeq9KQ\""}},"responseTime":287,"msg":"request_complete"}
✔ returns 404 when accessing a non-provisioned portfolio without bootstrap permission (308.2144ms)
{"level":30,"time":1763149551089,"pid":14044,"hostname":"i5-12600","req":{"id":"fea7801a-28d9-4a88-a2c6-f6d6ed5ad358","method":"POST","url":"/api/portfolio/test123","query":{},"params":{},"headers":{"host":"127.0.0.1:31583","accept-encoding":"gzip, deflate","content-type":"application/json","x-portfolio-key":"[REDACTED]","content-length":"52","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":31584},"component":"security_audit","event_type":"security","event":"auth_success","timestamp":"2025-11-14T19:45:51.089Z","request_id":"fea7801a-28d9-4a88-a2c6-f6d6ed5ad358","ip":"::ffff:127.0.0.1","portfolio_id":"test123","mode":"bootstrap"}
{"level":40,"time":1763149551096,"pid":14044,"hostname":"i5-12600","req":{"id":"fea7801a-28d9-4a88-a2c6-f6d6ed5ad358","method":"POST","url":"/api/portfolio/test123","query":{},"params":{},"headers":{"host":"127.0.0.1:31583","accept-encoding":"gzip, deflate","content-type":"application/json","x-portfolio-key":"[REDACTED]","content-length":"52","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":31584},"error":"Request validation failed.","code":"VALIDATION_ERROR","status":400,"msg":"request_error"}
{"level":30,"time":1763149551100,"pid":14044,"hostname":"i5-12600","req":{"id":"fea7801a-28d9-4a88-a2c6-f6d6ed5ad358","method":"POST","url":"/api/portfolio/test123","query":{},"params":{},"headers":{"host":"127.0.0.1:31583","accept-encoding":"gzip, deflate","content-type":"application/json","x-portfolio-key":"[REDACTED]","content-length":"52","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":31584},"res":{"statusCode":400,"headers":{"x-request-id":"fea7801a-28d9-4a88-a2c6-f6d6ed5ad358","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"19","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"318","etag":"W/\"13e-XOrLQuisbWdLTOIdm8bERPcl7/c\""}},"responseTime":231,"msg":"request_complete"}
✔ POST /api/portfolio rejects invalid payloads with validation details (376.0946ms)
{"level":40,"time":1763149551206,"pid":14044,"hostname":"i5-12600","req":{"id":"d003a4ad-2bc4-48b4-8481-70d531148578","method":"POST","url":"/api/portfolio/bad%20id","query":{},"params":{},"headers":{"host":"127.0.0.1:47909","accept-encoding":"gzip, deflate","content-type":"application/json","x-portfolio-key":"[REDACTED]","content-length":"19","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47910},"error":"Request validation failed.","code":"VALIDATION_ERROR","status":400,"msg":"request_error"}
{"level":30,"time":1763149551207,"pid":14044,"hostname":"i5-12600","req":{"id":"d003a4ad-2bc4-48b4-8481-70d531148578","method":"POST","url":"/api/portfolio/bad%20id","query":{},"params":{},"headers":{"host":"127.0.0.1:47909","accept-encoding":"gzip, deflate","content-type":"application/json","x-portfolio-key":"[REDACTED]","content-length":"19","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47910},"res":{"statusCode":400,"headers":{"x-request-id":"d003a4ad-2bc4-48b4-8481-70d531148578","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"19","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"171","etag":"W/\"ab-ikk385Y8IPqL+aRqO+g8dBr2zqY\""}},"responseTime":5,"msg":"request_complete"}
✔ POST /api/portfolio rejects invalid portfolio id (96.2455ms)
{"level":30,"time":1763149551535,"pid":14044,"hostname":"i5-12600","req":{"id":"c019f712-af57-4373-bd53-c2ea619727f5","method":"GET","url":"/api/returns/daily?per_page=2","query":{"per_page":"2"},"params":{},"headers":{"host":"127.0.0.1:47927","accept-encoding":"gzip, deflate","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47928},"res":{"statusCode":200,"headers":{"x-request-id":"c019f712-af57-4373-bd53-c2ea619727f5","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"19","ratelimit-reset":"60","cache-control":"private, max-age=600","etag":"2c1i2lU8Tg1jpMYhWYTDCxbH0nsfg-hyPeyUxOo2svI","content-type":"application/json; charset=utf-8","content-length":"500"}},"responseTime":194,"msg":"request_complete"}
{"level":30,"time":1763149551544,"pid":14044,"hostname":"i5-12600","req":{"id":"041e686c-8339-48c9-a059-e7482158260e","method":"GET","url":"/api/returns/daily?per_page=2","query":{"per_page":"2"},"params":{},"headers":{"host":"127.0.0.1:47943","accept-encoding":"gzip, deflate","if-none-match":"2c1i2lU8Tg1jpMYhWYTDCxbH0nsfg-hyPeyUxOo2svI","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47944},"res":{"statusCode":304,"headers":{"x-request-id":"041e686c-8339-48c9-a059-e7482158260e","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"18","ratelimit-reset":"60","cache-control":"private, max-age=600","etag":"2c1i2lU8Tg1jpMYhWYTDCxbH0nsfg-hyPeyUxOo2svI"}},"responseTime":3,"msg":"request_complete"}
✔ GET /api/returns/daily paginates and emits ETag (343.0318ms)
{"level":40,"time":1763149551646,"pid":14044,"hostname":"i5-12600","req":{"id":"f3bf3210-706b-49eb-938a-80ff9794c577","method":"GET","url":"/api/returns/daily?per_page=0","query":{"per_page":"0"},"params":{},"headers":{"host":"127.0.0.1:47949","accept-encoding":"gzip, deflate","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47950},"error":"Request validation failed.","code":"VALIDATION_ERROR","status":400,"msg":"request_error"}
{"level":30,"time":1763149551647,"pid":14044,"hostname":"i5-12600","req":{"id":"f3bf3210-706b-49eb-938a-80ff9794c577","method":"GET","url":"/api/returns/daily?per_page=0","query":{"per_page":"0"},"params":{},"headers":{"host":"127.0.0.1:47949","accept-encoding":"gzip, deflate","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47950},"res":{"statusCode":400,"headers":{"x-request-id":"f3bf3210-706b-49eb-938a-80ff9794c577","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"19","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"169","etag":"W/\"a9-mHPwFAihdJrHdiCk9mz5DAq/fls\""}},"responseTime":3,"msg":"request_complete"}
✔ GET /api/returns/daily validates pagination parameters (94.5109ms)
{"level":30,"time":1763149552009,"pid":14044,"hostname":"i5-12600","req":{"id":"69fbd317-64c4-4a74-a1dc-03bff6144628","method":"GET","url":"/api/nav/daily?per_page=2&page=2","query":{"per_page":"2","page":"2"},"params":{},"headers":{"host":"127.0.0.1:47961","accept-encoding":"gzip, deflate","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47964},"res":{"statusCode":200,"headers":{"x-request-id":"69fbd317-64c4-4a74-a1dc-03bff6144628","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"19","ratelimit-reset":"60","cache-control":"private, max-age=600","etag":"SCpIVB_UTLSzd8D5KPQz-wTZow_U8Y8dUiK4Ux_SmPw","content-type":"application/json; charset=utf-8","content-length":"238"}},"responseTime":196,"msg":"request_complete"}
✔ GET /api/nav/daily returns paginated snapshots with ETag (369.0224ms)
{"level":40,"time":1763149552105,"pid":14044,"hostname":"i5-12600","req":{"id":"05d47d98-2ba7-4a64-88d8-3ac6802a7748","method":"POST","url":"/api/admin/cash-rate","query":{},"params":{},"headers":{"host":"127.0.0.1:47977","accept-encoding":"gzip, deflate","content-type":"application/json","content-length":"43","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47978},"error":"Request validation failed.","code":"VALIDATION_ERROR","status":400,"msg":"request_error"}
{"level":30,"time":1763149552107,"pid":14044,"hostname":"i5-12600","req":{"id":"05d47d98-2ba7-4a64-88d8-3ac6802a7748","method":"POST","url":"/api/admin/cash-rate","query":{},"params":{},"headers":{"host":"127.0.0.1:47977","accept-encoding":"gzip, deflate","content-type":"application/json","content-length":"43","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47978},"res":{"statusCode":400,"headers":{"x-request-id":"05d47d98-2ba7-4a64-88d8-3ac6802a7748","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"100;w=60","ratelimit-limit":"100","ratelimit-remaining":"99","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"272","etag":"W/\"110-BglH5UnoQx6KS1DDUVntMKSX8bc\""}},"responseTime":4,"msg":"request_complete"}
✔ POST /api/admin/cash-rate enforces body validation (94.6595ms)
{"level":30,"time":1763149552360,"pid":14044,"hostname":"i5-12600","req":{"id":"87b096c5-e64e-4242-bea2-7687f12c296c","method":"POST","url":"/api/portfolio/ratelimit","query":{},"params":{},"headers":{"host":"127.0.0.1:47991","accept-encoding":"gzip, deflate","content-type":"application/json","x-portfolio-key":"[REDACTED]","content-length":"32","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47992},"component":"security_audit","event_type":"security","event":"auth_success","timestamp":"2025-11-14T19:45:52.360Z","request_id":"87b096c5-e64e-4242-bea2-7687f12c296c","ip":"::ffff:127.0.0.1","portfolio_id":"ratelimit","mode":"bootstrap"}
{"level":30,"time":1763149552372,"pid":14044,"hostname":"i5-12600","req":{"id":"87b096c5-e64e-4242-bea2-7687f12c296c","method":"POST","url":"/api/portfolio/ratelimit","query":{},"params":{},"headers":{"host":"127.0.0.1:47991","accept-encoding":"gzip, deflate","content-type":"application/json","x-portfolio-key":"[REDACTED]","content-length":"32","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47992},"res":{"statusCode":200,"headers":{"x-request-id":"87b096c5-e64e-4242-bea2-7687f12c296c","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"19","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"15","etag":"W/\"f-VaSQ4oDUiZblZNAEkkN+sX+q3Sg\""}},"responseTime":169,"msg":"request_complete"}
{"level":30,"time":1763149552383,"pid":14044,"hostname":"i5-12600","req":{"id":"3a129233-8738-4cef-95fb-99439a94d90e","method":"POST","url":"/api/portfolio/ratelimit","query":{},"params":{},"headers":{"host":"127.0.0.1:47997","accept-encoding":"gzip, deflate","content-type":"application/json","x-portfolio-key":"[REDACTED]","content-length":"32","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47998},"component":"security_audit","event_type":"security","event":"auth_success","timestamp":"2025-11-14T19:45:52.383Z","request_id":"3a129233-8738-4cef-95fb-99439a94d90e","ip":"::ffff:127.0.0.1","portfolio_id":"ratelimit","mode":"access"}
{"level":30,"time":1763149552398,"pid":14044,"hostname":"i5-12600","req":{"id":"3a129233-8738-4cef-95fb-99439a94d90e","method":"POST","url":"/api/portfolio/ratelimit","query":{},"params":{},"headers":{"host":"127.0.0.1:47997","accept-encoding":"gzip, deflate","content-type":"application/json","x-portfolio-key":"[REDACTED]","content-length":"32","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47998},"res":{"statusCode":200,"headers":{"x-request-id":"3a129233-8738-4cef-95fb-99439a94d90e","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"18","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"15","etag":"W/\"f-VaSQ4oDUiZblZNAEkkN+sX+q3Sg\""}},"responseTime":19,"msg":"request_complete"}
{"level":30,"time":1763149552408,"pid":14044,"hostname":"i5-12600","req":{"id":"b9168dfa-ae42-4c7b-b606-6c2e03794bdc","method":"POST","url":"/api/portfolio/ratelimit","query":{},"params":{},"headers":{"host":"127.0.0.1:47999","accept-encoding":"gzip, deflate","content-type":"application/json","x-portfolio-key":"[REDACTED]","content-length":"32","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48000},"component":"security_audit","event_type":"security","event":"auth_success","timestamp":"2025-11-14T19:45:52.407Z","request_id":"b9168dfa-ae42-4c7b-b606-6c2e03794bdc","ip":"::ffff:127.0.0.1","portfolio_id":"ratelimit","mode":"access"}
{"level":30,"time":1763149552416,"pid":14044,"hostname":"i5-12600","req":{"id":"b9168dfa-ae42-4c7b-b606-6c2e03794bdc","method":"POST","url":"/api/portfolio/ratelimit","query":{},"params":{},"headers":{"host":"127.0.0.1:47999","accept-encoding":"gzip, deflate","content-type":"application/json","x-portfolio-key":"[REDACTED]","content-length":"32","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48000},"res":{"statusCode":200,"headers":{"x-request-id":"b9168dfa-ae42-4c7b-b606-6c2e03794bdc","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"17","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"15","etag":"W/\"f-VaSQ4oDUiZblZNAEkkN+sX+q3Sg\""}},"responseTime":10,"msg":"request_complete"}
{"level":30,"time":1763149552423,"pid":14044,"hostname":"i5-12600","req":{"id":"3e976b3f-0095-48f4-8301-1a55dcf5a5fc","method":"POST","url":"/api/portfolio/ratelimit","query":{},"params":{},"headers":{"host":"127.0.0.1:48001","accept-encoding":"gzip, deflate","content-type":"application/json","x-portfolio-key":"[REDACTED]","content-length":"32","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48002},"component":"security_audit","event_type":"security","event":"auth_success","timestamp":"2025-11-14T19:45:52.422Z","request_id":"3e976b3f-0095-48f4-8301-1a55dcf5a5fc","ip":"::ffff:127.0.0.1","portfolio_id":"ratelimit","mode":"access"}
{"level":30,"time":1763149552434,"pid":14044,"hostname":"i5-12600","req":{"id":"3e976b3f-0095-48f4-8301-1a55dcf5a5fc","method":"POST","url":"/api/portfolio/ratelimit","query":{},"params":{},"headers":{"host":"127.0.0.1:48001","accept-encoding":"gzip, deflate","content-type":"application/json","x-portfolio-key":"[REDACTED]","content-length":"32","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48002},"res":{"statusCode":200,"headers":{"x-request-id":"3e976b3f-0095-48f4-8301-1a55dcf5a5fc","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"16","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"15","etag":"W/\"f-VaSQ4oDUiZblZNAEkkN+sX+q3Sg\""}},"responseTime":13,"msg":"request_complete"}
{"level":30,"time":1763149552441,"pid":14044,"hostname":"i5-12600","req":{"id":"7ed7103c-86af-48a1-b5bf-21b59561e8b8","method":"POST","url":"/api/portfolio/ratelimit","query":{},"params":{},"headers":{"host":"127.0.0.1:48007","accept-encoding":"gzip, deflate","content-type":"application/json","x-portfolio-key":"[REDACTED]","content-length":"32","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48008},"component":"security_audit","event_type":"security","event":"auth_success","timestamp":"2025-11-14T19:45:52.441Z","request_id":"7ed7103c-86af-48a1-b5bf-21b59561e8b8","ip":"::ffff:127.0.0.1","portfolio_id":"ratelimit","mode":"access"}
{"level":30,"time":1763149552451,"pid":14044,"hostname":"i5-12600","req":{"id":"7ed7103c-86af-48a1-b5bf-21b59561e8b8","method":"POST","url":"/api/portfolio/ratelimit","query":{},"params":{},"headers":{"host":"127.0.0.1:48007","accept-encoding":"gzip, deflate","content-type":"application/json","x-portfolio-key":"[REDACTED]","content-length":"32","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48008},"res":{"statusCode":200,"headers":{"x-request-id":"7ed7103c-86af-48a1-b5bf-21b59561e8b8","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"15","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"15","etag":"W/\"f-VaSQ4oDUiZblZNAEkkN+sX+q3Sg\""}},"responseTime":10,"msg":"request_complete"}
{"level":30,"time":1763149552458,"pid":14044,"hostname":"i5-12600","req":{"id":"a6a97a93-e567-4b87-b688-bec979b20ece","method":"POST","url":"/api/portfolio/ratelimit","query":{},"params":{},"headers":{"host":"127.0.0.1:48009","accept-encoding":"gzip, deflate","content-type":"application/json","x-portfolio-key":"[REDACTED]","content-length":"32","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48010},"component":"security_audit","event_type":"security","event":"auth_success","timestamp":"2025-11-14T19:45:52.458Z","request_id":"a6a97a93-e567-4b87-b688-bec979b20ece","ip":"::ffff:127.0.0.1","portfolio_id":"ratelimit","mode":"access"}
{"level":30,"time":1763149552468,"pid":14044,"hostname":"i5-12600","req":{"id":"a6a97a93-e567-4b87-b688-bec979b20ece","method":"POST","url":"/api/portfolio/ratelimit","query":{},"params":{},"headers":{"host":"127.0.0.1:48009","accept-encoding":"gzip, deflate","content-type":"application/json","x-portfolio-key":"[REDACTED]","content-length":"32","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48010},"res":{"statusCode":200,"headers":{"x-request-id":"a6a97a93-e567-4b87-b688-bec979b20ece","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"14","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"15","etag":"W/\"f-VaSQ4oDUiZblZNAEkkN+sX+q3Sg\""}},"responseTime":11,"msg":"request_complete"}
{"level":30,"time":1763149552478,"pid":14044,"hostname":"i5-12600","req":{"id":"c2d537bf-445e-4b3f-a4ad-901189f45dae","method":"POST","url":"/api/portfolio/ratelimit","query":{},"params":{},"headers":{"host":"127.0.0.1:48011","accept-encoding":"gzip, deflate","content-type":"application/json","x-portfolio-key":"[REDACTED]","content-length":"32","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48012},"component":"security_audit","event_type":"security","event":"auth_success","timestamp":"2025-11-14T19:45:52.478Z","request_id":"c2d537bf-445e-4b3f-a4ad-901189f45dae","ip":"::ffff:127.0.0.1","portfolio_id":"ratelimit","mode":"access"}
{"level":30,"time":1763149552491,"pid":14044,"hostname":"i5-12600","req":{"id":"c2d537bf-445e-4b3f-a4ad-901189f45dae","method":"POST","url":"/api/portfolio/ratelimit","query":{},"params":{},"headers":{"host":"127.0.0.1:48011","accept-encoding":"gzip, deflate","content-type":"application/json","x-portfolio-key":"[REDACTED]","content-length":"32","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48012},"res":{"statusCode":200,"headers":{"x-request-id":"c2d537bf-445e-4b3f-a4ad-901189f45dae","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"13","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"15","etag":"W/\"f-VaSQ4oDUiZblZNAEkkN+sX+q3Sg\""}},"responseTime":15,"msg":"request_complete"}
{"level":30,"time":1763149552501,"pid":14044,"hostname":"i5-12600","req":{"id":"f33eaaef-f252-460c-b099-54ae4687534d","method":"POST","url":"/api/portfolio/ratelimit","query":{},"params":{},"headers":{"host":"127.0.0.1:48015","accept-encoding":"gzip, deflate","content-type":"application/json","x-portfolio-key":"[REDACTED]","content-length":"32","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48016},"component":"security_audit","event_type":"security","event":"auth_success","timestamp":"2025-11-14T19:45:52.501Z","request_id":"f33eaaef-f252-460c-b099-54ae4687534d","ip":"::ffff:127.0.0.1","portfolio_id":"ratelimit","mode":"access"}
{"level":30,"time":1763149552514,"pid":14044,"hostname":"i5-12600","req":{"id":"f33eaaef-f252-460c-b099-54ae4687534d","method":"POST","url":"/api/portfolio/ratelimit","query":{},"params":{},"headers":{"host":"127.0.0.1:48015","accept-encoding":"gzip, deflate","content-type":"application/json","x-portfolio-key":"[REDACTED]","content-length":"32","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48016},"res":{"statusCode":200,"headers":{"x-request-id":"f33eaaef-f252-460c-b099-54ae4687534d","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"12","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"15","etag":"W/\"f-VaSQ4oDUiZblZNAEkkN+sX+q3Sg\""}},"responseTime":15,"msg":"request_complete"}
{"level":30,"time":1763149552521,"pid":14044,"hostname":"i5-12600","req":{"id":"11e21e25-9f94-446e-9eff-5a76caa3ae9c","method":"POST","url":"/api/portfolio/ratelimit","query":{},"params":{},"headers":{"host":"127.0.0.1:48020","accept-encoding":"gzip, deflate","content-type":"application/json","x-portfolio-key":"[REDACTED]","content-length":"32","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48022},"component":"security_audit","event_type":"security","event":"auth_success","timestamp":"2025-11-14T19:45:52.520Z","request_id":"11e21e25-9f94-446e-9eff-5a76caa3ae9c","ip":"::ffff:127.0.0.1","portfolio_id":"ratelimit","mode":"access"}
{"level":30,"time":1763149552529,"pid":14044,"hostname":"i5-12600","req":{"id":"11e21e25-9f94-446e-9eff-5a76caa3ae9c","method":"POST","url":"/api/portfolio/ratelimit","query":{},"params":{},"headers":{"host":"127.0.0.1:48020","accept-encoding":"gzip, deflate","content-type":"application/json","x-portfolio-key":"[REDACTED]","content-length":"32","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48022},"res":{"statusCode":200,"headers":{"x-request-id":"11e21e25-9f94-446e-9eff-5a76caa3ae9c","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"11","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"15","etag":"W/\"f-VaSQ4oDUiZblZNAEkkN+sX+q3Sg\""}},"responseTime":10,"msg":"request_complete"}
{"level":30,"time":1763149552536,"pid":14044,"hostname":"i5-12600","req":{"id":"06d3e7cc-c796-4244-a917-3e0bc2d7e5d8","method":"POST","url":"/api/portfolio/ratelimit","query":{},"params":{},"headers":{"host":"127.0.0.1:48023","accept-encoding":"gzip, deflate","content-type":"application/json","x-portfolio-key":"[REDACTED]","content-length":"32","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48024},"component":"security_audit","event_type":"security","event":"auth_success","timestamp":"2025-11-14T19:45:52.536Z","request_id":"06d3e7cc-c796-4244-a917-3e0bc2d7e5d8","ip":"::ffff:127.0.0.1","portfolio_id":"ratelimit","mode":"access"}
{"level":30,"time":1763149552546,"pid":14044,"hostname":"i5-12600","req":{"id":"06d3e7cc-c796-4244-a917-3e0bc2d7e5d8","method":"POST","url":"/api/portfolio/ratelimit","query":{},"params":{},"headers":{"host":"127.0.0.1:48023","accept-encoding":"gzip, deflate","content-type":"application/json","x-portfolio-key":"[REDACTED]","content-length":"32","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48024},"res":{"statusCode":200,"headers":{"x-request-id":"06d3e7cc-c796-4244-a917-3e0bc2d7e5d8","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"10","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"15","etag":"W/\"f-VaSQ4oDUiZblZNAEkkN+sX+q3Sg\""}},"responseTime":12,"msg":"request_complete"}
{"level":30,"time":1763149552554,"pid":14044,"hostname":"i5-12600","req":{"id":"10757dcf-c8bb-402c-baa3-4beed9fd54a7","method":"POST","url":"/api/portfolio/ratelimit","query":{},"params":{},"headers":{"host":"127.0.0.1:48025","accept-encoding":"gzip, deflate","content-type":"application/json","x-portfolio-key":"[REDACTED]","content-length":"32","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48026},"component":"security_audit","event_type":"security","event":"auth_success","timestamp":"2025-11-14T19:45:52.554Z","request_id":"10757dcf-c8bb-402c-baa3-4beed9fd54a7","ip":"::ffff:127.0.0.1","portfolio_id":"ratelimit","mode":"access"}
{"level":30,"time":1763149552564,"pid":14044,"hostname":"i5-12600","req":{"id":"10757dcf-c8bb-402c-baa3-4beed9fd54a7","method":"POST","url":"/api/portfolio/ratelimit","query":{},"params":{},"headers":{"host":"127.0.0.1:48025","accept-encoding":"gzip, deflate","content-type":"application/json","x-portfolio-key":"[REDACTED]","content-length":"32","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48026},"res":{"statusCode":200,"headers":{"x-request-id":"10757dcf-c8bb-402c-baa3-4beed9fd54a7","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"9","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"15","etag":"W/\"f-VaSQ4oDUiZblZNAEkkN+sX+q3Sg\""}},"responseTime":12,"msg":"request_complete"}
{"level":30,"time":1763149552572,"pid":14044,"hostname":"i5-12600","req":{"id":"416e9e02-7dbc-402c-abb0-ba98767c2e5f","method":"POST","url":"/api/portfolio/ratelimit","query":{},"params":{},"headers":{"host":"127.0.0.1:48027","accept-encoding":"gzip, deflate","content-type":"application/json","x-portfolio-key":"[REDACTED]","content-length":"32","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48028},"component":"security_audit","event_type":"security","event":"auth_success","timestamp":"2025-11-14T19:45:52.572Z","request_id":"416e9e02-7dbc-402c-abb0-ba98767c2e5f","ip":"::ffff:127.0.0.1","portfolio_id":"ratelimit","mode":"access"}
{"level":30,"time":1763149552583,"pid":14044,"hostname":"i5-12600","req":{"id":"416e9e02-7dbc-402c-abb0-ba98767c2e5f","method":"POST","url":"/api/portfolio/ratelimit","query":{},"params":{},"headers":{"host":"127.0.0.1:48027","accept-encoding":"gzip, deflate","content-type":"application/json","x-portfolio-key":"[REDACTED]","content-length":"32","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48028},"res":{"statusCode":200,"headers":{"x-request-id":"416e9e02-7dbc-402c-abb0-ba98767c2e5f","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"8","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"15","etag":"W/\"f-VaSQ4oDUiZblZNAEkkN+sX+q3Sg\""}},"responseTime":12,"msg":"request_complete"}
{"level":30,"time":1763149552592,"pid":14044,"hostname":"i5-12600","req":{"id":"b7ce70c7-5e35-47ac-a07c-0a54e1165273","method":"POST","url":"/api/portfolio/ratelimit","query":{},"params":{},"headers":{"host":"127.0.0.1:48029","accept-encoding":"gzip, deflate","content-type":"application/json","x-portfolio-key":"[REDACTED]","content-length":"32","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48030},"component":"security_audit","event_type":"security","event":"auth_success","timestamp":"2025-11-14T19:45:52.592Z","request_id":"b7ce70c7-5e35-47ac-a07c-0a54e1165273","ip":"::ffff:127.0.0.1","portfolio_id":"ratelimit","mode":"access"}
{"level":30,"time":1763149552601,"pid":14044,"hostname":"i5-12600","req":{"id":"b7ce70c7-5e35-47ac-a07c-0a54e1165273","method":"POST","url":"/api/portfolio/ratelimit","query":{},"params":{},"headers":{"host":"127.0.0.1:48029","accept-encoding":"gzip, deflate","content-type":"application/json","x-portfolio-key":"[REDACTED]","content-length":"32","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48030},"res":{"statusCode":200,"headers":{"x-request-id":"b7ce70c7-5e35-47ac-a07c-0a54e1165273","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"7","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"15","etag":"W/\"f-VaSQ4oDUiZblZNAEkkN+sX+q3Sg\""}},"responseTime":11,"msg":"request_complete"}
{"level":30,"time":1763149552609,"pid":14044,"hostname":"i5-12600","req":{"id":"7d15407f-d662-4cce-8d47-8798f329c431","method":"POST","url":"/api/portfolio/ratelimit","query":{},"params":{},"headers":{"host":"127.0.0.1:48031","accept-encoding":"gzip, deflate","content-type":"application/json","x-portfolio-key":"[REDACTED]","content-length":"32","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48032},"component":"security_audit","event_type":"security","event":"auth_success","timestamp":"2025-11-14T19:45:52.609Z","request_id":"7d15407f-d662-4cce-8d47-8798f329c431","ip":"::ffff:127.0.0.1","portfolio_id":"ratelimit","mode":"access"}
{"level":30,"time":1763149552619,"pid":14044,"hostname":"i5-12600","req":{"id":"7d15407f-d662-4cce-8d47-8798f329c431","method":"POST","url":"/api/portfolio/ratelimit","query":{},"params":{},"headers":{"host":"127.0.0.1:48031","accept-encoding":"gzip, deflate","content-type":"application/json","x-portfolio-key":"[REDACTED]","content-length":"32","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48032},"res":{"statusCode":200,"headers":{"x-request-id":"7d15407f-d662-4cce-8d47-8798f329c431","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"6","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"15","etag":"W/\"f-VaSQ4oDUiZblZNAEkkN+sX+q3Sg\""}},"responseTime":12,"msg":"request_complete"}
{"level":30,"time":1763149552630,"pid":14044,"hostname":"i5-12600","req":{"id":"9192139d-bac6-4a12-916a-1c018f94ac10","method":"POST","url":"/api/portfolio/ratelimit","query":{},"params":{},"headers":{"host":"127.0.0.1:48033","accept-encoding":"gzip, deflate","content-type":"application/json","x-portfolio-key":"[REDACTED]","content-length":"32","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48034},"component":"security_audit","event_type":"security","event":"auth_success","timestamp":"2025-11-14T19:45:52.629Z","request_id":"9192139d-bac6-4a12-916a-1c018f94ac10","ip":"::ffff:127.0.0.1","portfolio_id":"ratelimit","mode":"access"}
{"level":30,"time":1763149552642,"pid":14044,"hostname":"i5-12600","req":{"id":"9192139d-bac6-4a12-916a-1c018f94ac10","method":"POST","url":"/api/portfolio/ratelimit","query":{},"params":{},"headers":{"host":"127.0.0.1:48033","accept-encoding":"gzip, deflate","content-type":"application/json","x-portfolio-key":"[REDACTED]","content-length":"32","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48034},"res":{"statusCode":200,"headers":{"x-request-id":"9192139d-bac6-4a12-916a-1c018f94ac10","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"5","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"15","etag":"W/\"f-VaSQ4oDUiZblZNAEkkN+sX+q3Sg\""}},"responseTime":14,"msg":"request_complete"}
{"level":30,"time":1763149552655,"pid":14044,"hostname":"i5-12600","req":{"id":"59f5a266-50a0-440a-9c66-8ed0cdc2f882","method":"POST","url":"/api/portfolio/ratelimit","query":{},"params":{},"headers":{"host":"127.0.0.1:48035","accept-encoding":"gzip, deflate","content-type":"application/json","x-portfolio-key":"[REDACTED]","content-length":"32","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48036},"component":"security_audit","event_type":"security","event":"auth_success","timestamp":"2025-11-14T19:45:52.655Z","request_id":"59f5a266-50a0-440a-9c66-8ed0cdc2f882","ip":"::ffff:127.0.0.1","portfolio_id":"ratelimit","mode":"access"}
{"level":30,"time":1763149552670,"pid":14044,"hostname":"i5-12600","req":{"id":"59f5a266-50a0-440a-9c66-8ed0cdc2f882","method":"POST","url":"/api/portfolio/ratelimit","query":{},"params":{},"headers":{"host":"127.0.0.1:48035","accept-encoding":"gzip, deflate","content-type":"application/json","x-portfolio-key":"[REDACTED]","content-length":"32","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48036},"res":{"statusCode":200,"headers":{"x-request-id":"59f5a266-50a0-440a-9c66-8ed0cdc2f882","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"4","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"15","etag":"W/\"f-VaSQ4oDUiZblZNAEkkN+sX+q3Sg\""}},"responseTime":16,"msg":"request_complete"}
{"level":30,"time":1763149552680,"pid":14044,"hostname":"i5-12600","req":{"id":"7f3eceb4-cdf4-4f46-b0d9-613ec91a1bb4","method":"POST","url":"/api/portfolio/ratelimit","query":{},"params":{},"headers":{"host":"127.0.0.1:48037","accept-encoding":"gzip, deflate","content-type":"application/json","x-portfolio-key":"[REDACTED]","content-length":"32","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48038},"component":"security_audit","event_type":"security","event":"auth_success","timestamp":"2025-11-14T19:45:52.680Z","request_id":"7f3eceb4-cdf4-4f46-b0d9-613ec91a1bb4","ip":"::ffff:127.0.0.1","portfolio_id":"ratelimit","mode":"access"}
{"level":30,"time":1763149552691,"pid":14044,"hostname":"i5-12600","req":{"id":"7f3eceb4-cdf4-4f46-b0d9-613ec91a1bb4","method":"POST","url":"/api/portfolio/ratelimit","query":{},"params":{},"headers":{"host":"127.0.0.1:48037","accept-encoding":"gzip, deflate","content-type":"application/json","x-portfolio-key":"[REDACTED]","content-length":"32","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48038},"res":{"statusCode":200,"headers":{"x-request-id":"7f3eceb4-cdf4-4f46-b0d9-613ec91a1bb4","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"3","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"15","etag":"W/\"f-VaSQ4oDUiZblZNAEkkN+sX+q3Sg\""}},"responseTime":12,"msg":"request_complete"}
{"level":30,"time":1763149552697,"pid":14044,"hostname":"i5-12600","req":{"id":"a5d07a02-528f-41c2-a551-f4f53f1ab2d2","method":"POST","url":"/api/portfolio/ratelimit","query":{},"params":{},"headers":{"host":"127.0.0.1:48039","accept-encoding":"gzip, deflate","content-type":"application/json","x-portfolio-key":"[REDACTED]","content-length":"32","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48040},"component":"security_audit","event_type":"security","event":"auth_success","timestamp":"2025-11-14T19:45:52.697Z","request_id":"a5d07a02-528f-41c2-a551-f4f53f1ab2d2","ip":"::ffff:127.0.0.1","portfolio_id":"ratelimit","mode":"access"}
{"level":30,"time":1763149552709,"pid":14044,"hostname":"i5-12600","req":{"id":"a5d07a02-528f-41c2-a551-f4f53f1ab2d2","method":"POST","url":"/api/portfolio/ratelimit","query":{},"params":{},"headers":{"host":"127.0.0.1:48039","accept-encoding":"gzip, deflate","content-type":"application/json","x-portfolio-key":"[REDACTED]","content-length":"32","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48040},"res":{"statusCode":200,"headers":{"x-request-id":"a5d07a02-528f-41c2-a551-f4f53f1ab2d2","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"2","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"15","etag":"W/\"f-VaSQ4oDUiZblZNAEkkN+sX+q3Sg\""}},"responseTime":13,"msg":"request_complete"}
{"level":30,"time":1763149552716,"pid":14044,"hostname":"i5-12600","req":{"id":"dc4957a2-b711-4acd-b767-4ebd5305ea1a","method":"POST","url":"/api/portfolio/ratelimit","query":{},"params":{},"headers":{"host":"127.0.0.1:48043","accept-encoding":"gzip, deflate","content-type":"application/json","x-portfolio-key":"[REDACTED]","content-length":"32","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48044},"component":"security_audit","event_type":"security","event":"auth_success","timestamp":"2025-11-14T19:45:52.716Z","request_id":"dc4957a2-b711-4acd-b767-4ebd5305ea1a","ip":"::ffff:127.0.0.1","portfolio_id":"ratelimit","mode":"access"}
{"level":30,"time":1763149552724,"pid":14044,"hostname":"i5-12600","req":{"id":"dc4957a2-b711-4acd-b767-4ebd5305ea1a","method":"POST","url":"/api/portfolio/ratelimit","query":{},"params":{},"headers":{"host":"127.0.0.1:48043","accept-encoding":"gzip, deflate","content-type":"application/json","x-portfolio-key":"[REDACTED]","content-length":"32","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48044},"res":{"statusCode":200,"headers":{"x-request-id":"dc4957a2-b711-4acd-b767-4ebd5305ea1a","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"1","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"15","etag":"W/\"f-VaSQ4oDUiZblZNAEkkN+sX+q3Sg\""}},"responseTime":9,"msg":"request_complete"}
{"level":30,"time":1763149552732,"pid":14044,"hostname":"i5-12600","req":{"id":"bd6f240d-11b7-4805-849c-bef5d7220b29","method":"POST","url":"/api/portfolio/ratelimit","query":{},"params":{},"headers":{"host":"127.0.0.1:48045","accept-encoding":"gzip, deflate","content-type":"application/json","x-portfolio-key":"[REDACTED]","content-length":"32","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48046},"component":"security_audit","event_type":"security","event":"auth_success","timestamp":"2025-11-14T19:45:52.732Z","request_id":"bd6f240d-11b7-4805-849c-bef5d7220b29","ip":"::ffff:127.0.0.1","portfolio_id":"ratelimit","mode":"access"}
{"level":30,"time":1763149552751,"pid":14044,"hostname":"i5-12600","req":{"id":"bd6f240d-11b7-4805-849c-bef5d7220b29","method":"POST","url":"/api/portfolio/ratelimit","query":{},"params":{},"headers":{"host":"127.0.0.1:48045","accept-encoding":"gzip, deflate","content-type":"application/json","x-portfolio-key":"[REDACTED]","content-length":"32","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48046},"res":{"statusCode":200,"headers":{"x-request-id":"bd6f240d-11b7-4805-849c-bef5d7220b29","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"0","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"15","etag":"W/\"f-VaSQ4oDUiZblZNAEkkN+sX+q3Sg\""}},"responseTime":20,"msg":"request_complete"}
{"level":30,"time":1763149552760,"pid":14044,"hostname":"i5-12600","req":{"id":"45de51cf-62ae-4456-a18d-27213fc9503f","method":"POST","url":"/api/portfolio/ratelimit","query":{},"params":{},"headers":{"host":"127.0.0.1:48047","accept-encoding":"gzip, deflate","content-type":"application/json","x-portfolio-key":"[REDACTED]","content-length":"32","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48048},"component":"security_audit","event_type":"security","event":"rate_limit_exceeded","timestamp":"2025-11-14T19:45:52.760Z","request_id":"45de51cf-62ae-4456-a18d-27213fc9503f","ip":"::ffff:127.0.0.1","scope":"portfolio","route":"/api/portfolio/ratelimit","limit":20,"window_ms":60000}
{"level":30,"time":1763149552761,"pid":14044,"hostname":"i5-12600","req":{"id":"45de51cf-62ae-4456-a18d-27213fc9503f","method":"POST","url":"/api/portfolio/ratelimit","query":{},"params":{},"headers":{"host":"127.0.0.1:48047","accept-encoding":"gzip, deflate","content-type":"application/json","x-portfolio-key":"[REDACTED]","content-length":"32","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48048},"res":{"statusCode":429,"headers":{"x-request-id":"45de51cf-62ae-4456-a18d-27213fc9503f","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"0","ratelimit-reset":"60","retry-after":"60","content-type":"text/html; charset=utf-8","content-length":"42","etag":"W/\"2a-UpTsLJ74nYuiLgNgEwlQMxGqwrE\""}},"responseTime":3,"msg":"request_complete"}
✔ POST /api/portfolio enforces rate limiting (657.3025ms)
{"level":30,"time":1763149551187,"pid":12340,"hostname":"i5-12600","req":{"id":"316407c2-aab2-4aed-a4df-446cc102fdda","method":"POST","url":"/api/portfolio/audit-security","query":{},"params":{},"headers":{"host":"127.0.0.1:31579","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","content-type":"application/json","content-length":"19","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":31580},"component":"security_audit","event_type":"security","event":"auth_success","timestamp":"2025-11-14T19:45:51.187Z","request_id":"316407c2-aab2-4aed-a4df-446cc102fdda","ip":"::ffff:127.0.0.1","portfolio_id":"audit-security","mode":"bootstrap"}
{"level":30,"time":1763149551216,"pid":12340,"hostname":"i5-12600","req":{"id":"316407c2-aab2-4aed-a4df-446cc102fdda","method":"POST","url":"/api/portfolio/audit-security","query":{},"params":{},"headers":{"host":"127.0.0.1:31579","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","content-type":"application/json","content-length":"19","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":31580},"res":{"statusCode":200,"headers":{"x-request-id":"316407c2-aab2-4aed-a4df-446cc102fdda","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"5;w=1","ratelimit-limit":"5","ratelimit-remaining":"4","ratelimit-reset":"1","content-type":"application/json; charset=utf-8","content-length":"15","etag":"W/\"f-VaSQ4oDUiZblZNAEkkN+sX+q3Sg\""}},"responseTime":381,"msg":"request_complete"}
{"level":30,"time":1763149551237,"pid":12340,"hostname":"i5-12600","req":{"id":"51c4d08d-2085-435a-9bdb-52c99631fc6d","method":"GET","url":"/api/portfolio/audit-security","query":{},"params":{},"headers":{"host":"127.0.0.1:47913","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47914},"component":"security_audit","event_type":"security","event":"auth_failed","timestamp":"2025-11-14T19:45:51.236Z","request_id":"51c4d08d-2085-435a-9bdb-52c99631fc6d","ip":"::ffff:127.0.0.1","portfolio_id":"audit-security","reason":"invalid_key","blocked":false,"attempts":1,"remaining_attempts":4,"retry_after_seconds":null}
{"level":40,"time":1763149551238,"pid":12340,"hostname":"i5-12600","req":{"id":"51c4d08d-2085-435a-9bdb-52c99631fc6d","method":"GET","url":"/api/portfolio/audit-security","query":{},"params":{},"headers":{"host":"127.0.0.1:47913","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47914},"error":"Invalid portfolio key.","code":"INVALID_KEY","status":403,"msg":"request_error"}
{"level":30,"time":1763149551240,"pid":12340,"hostname":"i5-12600","req":{"id":"51c4d08d-2085-435a-9bdb-52c99631fc6d","method":"GET","url":"/api/portfolio/audit-security","query":{},"params":{},"headers":{"host":"127.0.0.1:47913","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47914},"res":{"statusCode":403,"headers":{"x-request-id":"51c4d08d-2085-435a-9bdb-52c99631fc6d","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"5;w=1","ratelimit-limit":"5","ratelimit-remaining":"3","ratelimit-reset":"1","content-type":"application/json; charset=utf-8","content-length":"93","etag":"W/\"5d-z2XCAZDCVppYExLV+Xd2JNcJJPE\""}},"responseTime":5,"msg":"request_complete"}
{"level":30,"time":1763149551252,"pid":12340,"hostname":"i5-12600","req":{"id":"0cdf3b88-4526-408b-adbc-ab280c1a85ea","method":"POST","url":"/api/portfolio/audit-security","query":{},"params":{},"headers":{"host":"127.0.0.1:47915","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","x-portfolio-key-new":"[REDACTED]","content-type":"application/json","content-length":"19","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47916},"component":"security_audit","event_type":"security","event":"weak_key_rejected","timestamp":"2025-11-14T19:45:51.252Z","request_id":"0cdf3b88-4526-408b-adbc-ab280c1a85ea","ip":"::ffff:127.0.0.1","portfolio_id":"audit-security","action":"rotate","issues":["API key must be at least 12 characters long","API key does not meet strength requirements"]}
{"level":40,"time":1763149551253,"pid":12340,"hostname":"i5-12600","req":{"id":"0cdf3b88-4526-408b-adbc-ab280c1a85ea","method":"POST","url":"/api/portfolio/audit-security","query":{},"params":{},"headers":{"host":"127.0.0.1:47915","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","x-portfolio-key-new":"[REDACTED]","content-type":"application/json","content-length":"19","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47916},"error":"API key does not meet strength requirements","code":"WEAK_KEY","status":400,"msg":"request_error"}
{"level":30,"time":1763149551253,"pid":12340,"hostname":"i5-12600","req":{"id":"0cdf3b88-4526-408b-adbc-ab280c1a85ea","method":"POST","url":"/api/portfolio/audit-security","query":{},"params":{},"headers":{"host":"127.0.0.1:47915","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","x-portfolio-key-new":"[REDACTED]","content-type":"application/json","content-length":"19","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47916},"res":{"statusCode":400,"headers":{"x-request-id":"0cdf3b88-4526-408b-adbc-ab280c1a85ea","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"5;w=1","ratelimit-limit":"5","ratelimit-remaining":"2","ratelimit-reset":"1","content-type":"application/json; charset=utf-8","content-length":"240","etag":"W/\"f0-HZLyOFjtQDbqkIieMMP8l2UThCE\""}},"responseTime":3,"msg":"request_complete"}
{"level":30,"time":1763149551264,"pid":12340,"hostname":"i5-12600","req":{"id":"88a0f712-5471-42af-bd84-f1969be4fd3d","method":"POST","url":"/api/portfolio/audit-security","query":{},"params":{},"headers":{"host":"127.0.0.1:47917","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","x-portfolio-key-new":"[REDACTED]","content-type":"application/json","content-length":"19","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47918},"component":"security_audit","event_type":"security","event":"key_rotated","timestamp":"2025-11-14T19:45:51.264Z","request_id":"88a0f712-5471-42af-bd84-f1969be4fd3d","ip":"::ffff:127.0.0.1","portfolio_id":"audit-security"}
{"level":30,"time":1763149551265,"pid":12340,"hostname":"i5-12600","req":{"id":"88a0f712-5471-42af-bd84-f1969be4fd3d","method":"POST","url":"/api/portfolio/audit-security","query":{},"params":{},"headers":{"host":"127.0.0.1:47917","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","x-portfolio-key-new":"[REDACTED]","content-type":"application/json","content-length":"19","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47918},"component":"security_audit","event_type":"security","event":"auth_success","timestamp":"2025-11-14T19:45:51.264Z","request_id":"88a0f712-5471-42af-bd84-f1969be4fd3d","ip":"::ffff:127.0.0.1","portfolio_id":"audit-security","mode":"access"}
{"level":30,"time":1763149551277,"pid":12340,"hostname":"i5-12600","req":{"id":"88a0f712-5471-42af-bd84-f1969be4fd3d","method":"POST","url":"/api/portfolio/audit-security","query":{},"params":{},"headers":{"host":"127.0.0.1:47917","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","x-portfolio-key-new":"[REDACTED]","content-type":"application/json","content-length":"19","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47918},"res":{"statusCode":200,"headers":{"x-request-id":"88a0f712-5471-42af-bd84-f1969be4fd3d","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"5;w=1","ratelimit-limit":"5","ratelimit-remaining":"1","ratelimit-reset":"1","content-type":"application/json; charset=utf-8","content-length":"15","etag":"W/\"f-VaSQ4oDUiZblZNAEkkN+sX+q3Sg\""}},"responseTime":17,"msg":"request_complete"}
▶ security audit logging
  ✔ auth lifecycle emits expected audit events (503.8762ms)
{"level":30,"time":1763149551544,"pid":12340,"hostname":"i5-12600","req":{"id":"cf4e14d6-f1e0-4cc5-837b-17b401b263a6","method":"POST","url":"/api/portfolio/audit-security-rate","query":{},"params":{},"headers":{"host":"127.0.0.1:47925","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","content-type":"application/json","content-length":"19","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47926},"component":"security_audit","event_type":"security","event":"auth_success","timestamp":"2025-11-14T19:45:51.544Z","request_id":"cf4e14d6-f1e0-4cc5-837b-17b401b263a6","ip":"::ffff:127.0.0.1","portfolio_id":"audit-security-rate","mode":"bootstrap"}
{"level":30,"time":1763149551553,"pid":12340,"hostname":"i5-12600","req":{"id":"cf4e14d6-f1e0-4cc5-837b-17b401b263a6","method":"POST","url":"/api/portfolio/audit-security-rate","query":{},"params":{},"headers":{"host":"127.0.0.1:47925","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","content-type":"application/json","content-length":"19","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47926},"res":{"statusCode":200,"headers":{"x-request-id":"cf4e14d6-f1e0-4cc5-837b-17b401b263a6","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"1;w=5","ratelimit-limit":"1","ratelimit-remaining":"0","ratelimit-reset":"5","content-type":"application/json; charset=utf-8","content-length":"15","etag":"W/\"f-VaSQ4oDUiZblZNAEkkN+sX+q3Sg\""}},"responseTime":249,"msg":"request_complete"}
{"level":30,"time":1763149551561,"pid":12340,"hostname":"i5-12600","req":{"id":"013618d6-c882-4a2c-b722-9f31131a032c","method":"POST","url":"/api/portfolio/audit-security-rate","query":{},"params":{},"headers":{"host":"127.0.0.1:47945","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","content-type":"application/json","content-length":"19","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47946},"component":"security_audit","event_type":"security","event":"rate_limit_exceeded","timestamp":"2025-11-14T19:45:51.561Z","request_id":"013618d6-c882-4a2c-b722-9f31131a032c","ip":"::ffff:127.0.0.1","scope":"portfolio","route":"/api/portfolio/audit-security-rate","limit":1,"window_ms":5000}
{"level":30,"time":1763149551562,"pid":12340,"hostname":"i5-12600","req":{"id":"013618d6-c882-4a2c-b722-9f31131a032c","method":"POST","url":"/api/portfolio/audit-security-rate","query":{},"params":{},"headers":{"host":"127.0.0.1:47945","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","content-type":"application/json","content-length":"19","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47946},"res":{"statusCode":429,"headers":{"x-request-id":"013618d6-c882-4a2c-b722-9f31131a032c","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"1;w=5","ratelimit-limit":"1","ratelimit-remaining":"0","ratelimit-reset":"5","retry-after":"5","content-type":"text/html; charset=utf-8","content-length":"42","etag":"W/\"2a-UpTsLJ74nYuiLgNgEwlQMxGqwrE\""}},"responseTime":3,"msg":"request_complete"}
  ✔ rate limiting logs audit events (284.7108ms)
✔ security audit logging (790.3788ms)
{"level":30,"time":1763149551365,"pid":13284,"hostname":"i5-12600","req":{"id":"56cd4fff-b15f-49e5-b13b-9f5b46d4b5de","method":"POST","url":"/api/portfolio/bf-4f022df1-5e12-4a25-9904-d492bc27500a","query":{},"params":{},"headers":{"host":"127.0.0.1:47897","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","content-type":"application/json","content-length":"32","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47898},"component":"security_audit","event_type":"security","event":"auth_success","timestamp":"2025-11-14T19:45:51.365Z","request_id":"56cd4fff-b15f-49e5-b13b-9f5b46d4b5de","ip":"::ffff:127.0.0.1","portfolio_id":"bf-4f022df1-5e12-4a25-9904-d492bc27500a","mode":"bootstrap"}
{"level":30,"time":1763149551393,"pid":13284,"hostname":"i5-12600","req":{"id":"56cd4fff-b15f-49e5-b13b-9f5b46d4b5de","method":"POST","url":"/api/portfolio/bf-4f022df1-5e12-4a25-9904-d492bc27500a","query":{},"params":{},"headers":{"host":"127.0.0.1:47897","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","content-type":"application/json","content-length":"32","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47898},"res":{"statusCode":200,"headers":{"x-request-id":"56cd4fff-b15f-49e5-b13b-9f5b46d4b5de","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"19","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"15","etag":"W/\"f-VaSQ4oDUiZblZNAEkkN+sX+q3Sg\""}},"responseTime":364,"msg":"request_complete"}
{"level":30,"time":1763149551412,"pid":13284,"hostname":"i5-12600","req":{"id":"21428461-fe5b-4d5a-9315-a034b52c86ef","method":"GET","url":"/api/portfolio/bf-4f022df1-5e12-4a25-9904-d492bc27500a","query":{},"params":{},"headers":{"host":"127.0.0.1:47929","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47930},"component":"security_audit","event_type":"security","event":"auth_failed","timestamp":"2025-11-14T19:45:51.411Z","request_id":"21428461-fe5b-4d5a-9315-a034b52c86ef","ip":"::ffff:127.0.0.1","portfolio_id":"bf-4f022df1-5e12-4a25-9904-d492bc27500a","reason":"invalid_key","blocked":false,"attempts":1,"remaining_attempts":2,"retry_after_seconds":null}
{"level":40,"time":1763149551412,"pid":13284,"hostname":"i5-12600","req":{"id":"21428461-fe5b-4d5a-9315-a034b52c86ef","method":"GET","url":"/api/portfolio/bf-4f022df1-5e12-4a25-9904-d492bc27500a","query":{},"params":{},"headers":{"host":"127.0.0.1:47929","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47930},"error":"Invalid portfolio key.","code":"INVALID_KEY","status":403,"msg":"request_error"}
{"level":30,"time":1763149551413,"pid":13284,"hostname":"i5-12600","req":{"id":"21428461-fe5b-4d5a-9315-a034b52c86ef","method":"GET","url":"/api/portfolio/bf-4f022df1-5e12-4a25-9904-d492bc27500a","query":{},"params":{},"headers":{"host":"127.0.0.1:47929","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47930},"res":{"statusCode":403,"headers":{"x-request-id":"21428461-fe5b-4d5a-9315-a034b52c86ef","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"18","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"93","etag":"W/\"5d-ELcfWRGClygcgbKqalSEh8giJgw\""}},"responseTime":4,"msg":"request_complete"}
{"level":30,"time":1763149551424,"pid":13284,"hostname":"i5-12600","req":{"id":"95e2b150-7625-4889-bd9c-0b7a72e69594","method":"GET","url":"/api/portfolio/bf-4f022df1-5e12-4a25-9904-d492bc27500a","query":{},"params":{},"headers":{"host":"127.0.0.1:47931","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47932},"component":"security_audit","event_type":"security","event":"auth_failed","timestamp":"2025-11-14T19:45:51.424Z","request_id":"95e2b150-7625-4889-bd9c-0b7a72e69594","ip":"::ffff:127.0.0.1","portfolio_id":"bf-4f022df1-5e12-4a25-9904-d492bc27500a","reason":"invalid_key","blocked":false,"attempts":2,"remaining_attempts":1,"retry_after_seconds":null}
{"level":40,"time":1763149551424,"pid":13284,"hostname":"i5-12600","req":{"id":"95e2b150-7625-4889-bd9c-0b7a72e69594","method":"GET","url":"/api/portfolio/bf-4f022df1-5e12-4a25-9904-d492bc27500a","query":{},"params":{},"headers":{"host":"127.0.0.1:47931","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47932},"error":"Invalid portfolio key.","code":"INVALID_KEY","status":403,"msg":"request_error"}
{"level":30,"time":1763149551425,"pid":13284,"hostname":"i5-12600","req":{"id":"95e2b150-7625-4889-bd9c-0b7a72e69594","method":"GET","url":"/api/portfolio/bf-4f022df1-5e12-4a25-9904-d492bc27500a","query":{},"params":{},"headers":{"host":"127.0.0.1:47931","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47932},"res":{"statusCode":403,"headers":{"x-request-id":"95e2b150-7625-4889-bd9c-0b7a72e69594","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"17","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"93","etag":"W/\"5d-RTDrvLGkJFk4Wf6g751GoYZliLE\""}},"responseTime":2,"msg":"request_complete"}
{"level":30,"time":1763149551432,"pid":13284,"hostname":"i5-12600","req":{"id":"e088eee7-7e1c-4c8b-86ab-7c60f43d68e9","method":"GET","url":"/api/portfolio/bf-4f022df1-5e12-4a25-9904-d492bc27500a","query":{},"params":{},"headers":{"host":"127.0.0.1:47933","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47934},"component":"security_audit","event_type":"security","event":"auth_failed","timestamp":"2025-11-14T19:45:51.431Z","request_id":"e088eee7-7e1c-4c8b-86ab-7c60f43d68e9","ip":"::ffff:127.0.0.1","portfolio_id":"bf-4f022df1-5e12-4a25-9904-d492bc27500a","reason":"invalid_key","blocked":true,"attempts":3,"remaining_attempts":null,"retry_after_seconds":1}
{"level":40,"time":1763149551432,"pid":13284,"hostname":"i5-12600","req":{"id":"e088eee7-7e1c-4c8b-86ab-7c60f43d68e9","method":"GET","url":"/api/portfolio/bf-4f022df1-5e12-4a25-9904-d492bc27500a","query":{},"params":{},"headers":{"host":"127.0.0.1:47933","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47934},"error":"Too many invalid portfolio key attempts. Try again later.","code":"TOO_MANY_KEY_ATTEMPTS","status":429,"msg":"request_error"}
{"level":30,"time":1763149551433,"pid":13284,"hostname":"i5-12600","req":{"id":"e088eee7-7e1c-4c8b-86ab-7c60f43d68e9","method":"GET","url":"/api/portfolio/bf-4f022df1-5e12-4a25-9904-d492bc27500a","query":{},"params":{},"headers":{"host":"127.0.0.1:47933","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47934},"res":{"statusCode":429,"headers":{"x-request-id":"e088eee7-7e1c-4c8b-86ab-7c60f43d68e9","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"16","ratelimit-reset":"60","retry-after":"1","content-type":"application/json; charset=utf-8","content-length":"103","etag":"W/\"67-I3qYWO1Ta4yFxmvaMkJJHkDFSp4\""}},"responseTime":3,"msg":"request_complete"}
✔ locks out after reaching maximum invalid attempts (463.5715ms)
{"level":30,"time":1763149551723,"pid":13284,"hostname":"i5-12600","req":{"id":"5f5b3faf-9886-40bf-adbe-7e3857fd751f","method":"POST","url":"/api/portfolio/bf-clear-69376467-7931-4f01-ba8e-847dd213b818","query":{},"params":{},"headers":{"host":"127.0.0.1:47935","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","content-type":"application/json","content-length":"32","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47936},"component":"security_audit","event_type":"security","event":"auth_success","timestamp":"2025-11-14T19:45:51.723Z","request_id":"5f5b3faf-9886-40bf-adbe-7e3857fd751f","ip":"::ffff:127.0.0.1","portfolio_id":"bf-clear-69376467-7931-4f01-ba8e-847dd213b818","mode":"bootstrap"}
{"level":30,"time":1763149551741,"pid":13284,"hostname":"i5-12600","req":{"id":"5f5b3faf-9886-40bf-adbe-7e3857fd751f","method":"POST","url":"/api/portfolio/bf-clear-69376467-7931-4f01-ba8e-847dd213b818","query":{},"params":{},"headers":{"host":"127.0.0.1:47935","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","content-type":"application/json","content-length":"32","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47936},"res":{"statusCode":200,"headers":{"x-request-id":"5f5b3faf-9886-40bf-adbe-7e3857fd751f","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"19","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"15","etag":"W/\"f-VaSQ4oDUiZblZNAEkkN+sX+q3Sg\""}},"responseTime":282,"msg":"request_complete"}
{"level":30,"time":1763149551755,"pid":13284,"hostname":"i5-12600","req":{"id":"d23a38fe-489c-4b89-a6c4-70410f2383bf","method":"GET","url":"/api/portfolio/bf-clear-69376467-7931-4f01-ba8e-847dd213b818","query":{},"params":{},"headers":{"host":"127.0.0.1:47951","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47952},"component":"security_audit","event_type":"security","event":"auth_failed","timestamp":"2025-11-14T19:45:51.755Z","request_id":"d23a38fe-489c-4b89-a6c4-70410f2383bf","ip":"::ffff:127.0.0.1","portfolio_id":"bf-clear-69376467-7931-4f01-ba8e-847dd213b818","reason":"invalid_key","blocked":false,"attempts":1,"remaining_attempts":3,"retry_after_seconds":null}
{"level":40,"time":1763149551757,"pid":13284,"hostname":"i5-12600","req":{"id":"d23a38fe-489c-4b89-a6c4-70410f2383bf","method":"GET","url":"/api/portfolio/bf-clear-69376467-7931-4f01-ba8e-847dd213b818","query":{},"params":{},"headers":{"host":"127.0.0.1:47951","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47952},"error":"Invalid portfolio key.","code":"INVALID_KEY","status":403,"msg":"request_error"}
{"level":30,"time":1763149551759,"pid":13284,"hostname":"i5-12600","req":{"id":"d23a38fe-489c-4b89-a6c4-70410f2383bf","method":"GET","url":"/api/portfolio/bf-clear-69376467-7931-4f01-ba8e-847dd213b818","query":{},"params":{},"headers":{"host":"127.0.0.1:47951","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47952},"res":{"statusCode":403,"headers":{"x-request-id":"d23a38fe-489c-4b89-a6c4-70410f2383bf","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"18","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"93","etag":"W/\"5d-oEJXqU1tUkCC1TuzUM/dMhqECRM\""}},"responseTime":5,"msg":"request_complete"}
{"level":30,"time":1763149551766,"pid":13284,"hostname":"i5-12600","req":{"id":"6ad1917d-6659-4d28-ac96-bb317360c15c","method":"GET","url":"/api/portfolio/bf-clear-69376467-7931-4f01-ba8e-847dd213b818","query":{},"params":{},"headers":{"host":"127.0.0.1:47953","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47954},"component":"security_audit","event_type":"security","event":"auth_failed","timestamp":"2025-11-14T19:45:51.766Z","request_id":"6ad1917d-6659-4d28-ac96-bb317360c15c","ip":"::ffff:127.0.0.1","portfolio_id":"bf-clear-69376467-7931-4f01-ba8e-847dd213b818","reason":"invalid_key","blocked":false,"attempts":2,"remaining_attempts":2,"retry_after_seconds":null}
{"level":40,"time":1763149551766,"pid":13284,"hostname":"i5-12600","req":{"id":"6ad1917d-6659-4d28-ac96-bb317360c15c","method":"GET","url":"/api/portfolio/bf-clear-69376467-7931-4f01-ba8e-847dd213b818","query":{},"params":{},"headers":{"host":"127.0.0.1:47953","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47954},"error":"Invalid portfolio key.","code":"INVALID_KEY","status":403,"msg":"request_error"}
{"level":30,"time":1763149551767,"pid":13284,"hostname":"i5-12600","req":{"id":"6ad1917d-6659-4d28-ac96-bb317360c15c","method":"GET","url":"/api/portfolio/bf-clear-69376467-7931-4f01-ba8e-847dd213b818","query":{},"params":{},"headers":{"host":"127.0.0.1:47953","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47954},"res":{"statusCode":403,"headers":{"x-request-id":"6ad1917d-6659-4d28-ac96-bb317360c15c","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"17","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"93","etag":"W/\"5d-ELcfWRGClygcgbKqalSEh8giJgw\""}},"responseTime":2,"msg":"request_complete"}
{"level":30,"time":1763149551775,"pid":13284,"hostname":"i5-12600","req":{"id":"a18a7a83-5f25-4c6e-adbc-7966e35d130c","method":"GET","url":"/api/portfolio/bf-clear-69376467-7931-4f01-ba8e-847dd213b818","query":{},"params":{},"headers":{"host":"127.0.0.1:47955","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47956},"component":"security_audit","event_type":"security","event":"auth_success","timestamp":"2025-11-14T19:45:51.774Z","request_id":"a18a7a83-5f25-4c6e-adbc-7966e35d130c","ip":"::ffff:127.0.0.1","portfolio_id":"bf-clear-69376467-7931-4f01-ba8e-847dd213b818","mode":"access"}
{"level":30,"time":1763149551779,"pid":13284,"hostname":"i5-12600","req":{"id":"a18a7a83-5f25-4c6e-adbc-7966e35d130c","method":"GET","url":"/api/portfolio/bf-clear-69376467-7931-4f01-ba8e-847dd213b818","query":{},"params":{},"headers":{"host":"127.0.0.1:47955","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47956},"res":{"statusCode":200,"headers":{"x-request-id":"a18a7a83-5f25-4c6e-adbc-7966e35d130c","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"16","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"135","etag":"W/\"87-rKvhb1l54tIElzSP2SLCMvrkOBA\""}},"responseTime":6,"msg":"request_complete"}
{"level":30,"time":1763149551788,"pid":13284,"hostname":"i5-12600","req":{"id":"ef18133e-597c-4086-97b9-44e50d1d003f","method":"GET","url":"/api/portfolio/bf-clear-69376467-7931-4f01-ba8e-847dd213b818","query":{},"params":{},"headers":{"host":"127.0.0.1:47957","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47958},"component":"security_audit","event_type":"security","event":"auth_failed","timestamp":"2025-11-14T19:45:51.788Z","request_id":"ef18133e-597c-4086-97b9-44e50d1d003f","ip":"::ffff:127.0.0.1","portfolio_id":"bf-clear-69376467-7931-4f01-ba8e-847dd213b818","reason":"invalid_key","blocked":false,"attempts":1,"remaining_attempts":3,"retry_after_seconds":null}
{"level":40,"time":1763149551788,"pid":13284,"hostname":"i5-12600","req":{"id":"ef18133e-597c-4086-97b9-44e50d1d003f","method":"GET","url":"/api/portfolio/bf-clear-69376467-7931-4f01-ba8e-847dd213b818","query":{},"params":{},"headers":{"host":"127.0.0.1:47957","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47958},"error":"Invalid portfolio key.","code":"INVALID_KEY","status":403,"msg":"request_error"}
{"level":30,"time":1763149551789,"pid":13284,"hostname":"i5-12600","req":{"id":"ef18133e-597c-4086-97b9-44e50d1d003f","method":"GET","url":"/api/portfolio/bf-clear-69376467-7931-4f01-ba8e-847dd213b818","query":{},"params":{},"headers":{"host":"127.0.0.1:47957","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47958},"res":{"statusCode":403,"headers":{"x-request-id":"ef18133e-597c-4086-97b9-44e50d1d003f","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"15","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"93","etag":"W/\"5d-oEJXqU1tUkCC1TuzUM/dMhqECRM\""}},"responseTime":4,"msg":"request_complete"}
✔ successful authentication clears prior failures (351.6783ms)
{"level":30,"time":1763149552088,"pid":13284,"hostname":"i5-12600","req":{"id":"a4b2ae89-8908-4f3d-8cce-ac721dd8626a","method":"POST","url":"/api/portfolio/bf-progressive-23e4adec-b6fd-411a-9b27-d7134757e899","query":{},"params":{},"headers":{"host":"127.0.0.1:47962","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","content-type":"application/json","content-length":"32","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47963},"component":"security_audit","event_type":"security","event":"auth_success","timestamp":"2025-11-14T19:45:52.088Z","request_id":"a4b2ae89-8908-4f3d-8cce-ac721dd8626a","ip":"::ffff:127.0.0.1","portfolio_id":"bf-progressive-23e4adec-b6fd-411a-9b27-d7134757e899","mode":"bootstrap"}
{"level":30,"time":1763149552106,"pid":13284,"hostname":"i5-12600","req":{"id":"a4b2ae89-8908-4f3d-8cce-ac721dd8626a","method":"POST","url":"/api/portfolio/bf-progressive-23e4adec-b6fd-411a-9b27-d7134757e899","query":{},"params":{},"headers":{"host":"127.0.0.1:47962","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","content-type":"application/json","content-length":"32","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47963},"res":{"statusCode":200,"headers":{"x-request-id":"a4b2ae89-8908-4f3d-8cce-ac721dd8626a","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"19","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"15","etag":"W/\"f-VaSQ4oDUiZblZNAEkkN+sX+q3Sg\""}},"responseTime":295,"msg":"request_complete"}
{"level":30,"time":1763149552120,"pid":13284,"hostname":"i5-12600","req":{"id":"9b73b91f-8c2e-4c2d-b551-b6c646005974","method":"GET","url":"/api/portfolio/bf-progressive-23e4adec-b6fd-411a-9b27-d7134757e899","query":{},"params":{},"headers":{"host":"127.0.0.1:47979","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47981},"component":"security_audit","event_type":"security","event":"auth_failed","timestamp":"2025-11-14T19:45:52.120Z","request_id":"9b73b91f-8c2e-4c2d-b551-b6c646005974","ip":"::ffff:127.0.0.1","portfolio_id":"bf-progressive-23e4adec-b6fd-411a-9b27-d7134757e899","reason":"invalid_key","blocked":false,"attempts":1,"remaining_attempts":2,"retry_after_seconds":null}
{"level":40,"time":1763149552121,"pid":13284,"hostname":"i5-12600","req":{"id":"9b73b91f-8c2e-4c2d-b551-b6c646005974","method":"GET","url":"/api/portfolio/bf-progressive-23e4adec-b6fd-411a-9b27-d7134757e899","query":{},"params":{},"headers":{"host":"127.0.0.1:47979","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47981},"error":"Invalid portfolio key.","code":"INVALID_KEY","status":403,"msg":"request_error"}
{"level":30,"time":1763149552124,"pid":13284,"hostname":"i5-12600","req":{"id":"9b73b91f-8c2e-4c2d-b551-b6c646005974","method":"GET","url":"/api/portfolio/bf-progressive-23e4adec-b6fd-411a-9b27-d7134757e899","query":{},"params":{},"headers":{"host":"127.0.0.1:47979","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47981},"res":{"statusCode":403,"headers":{"x-request-id":"9b73b91f-8c2e-4c2d-b551-b6c646005974","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"18","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"93","etag":"W/\"5d-ELcfWRGClygcgbKqalSEh8giJgw\""}},"responseTime":7,"msg":"request_complete"}
{"level":30,"time":1763149552135,"pid":13284,"hostname":"i5-12600","req":{"id":"1e0eea57-5e13-4e23-8b15-78d012f2e409","method":"GET","url":"/api/portfolio/bf-progressive-23e4adec-b6fd-411a-9b27-d7134757e899","query":{},"params":{},"headers":{"host":"127.0.0.1:47983","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47984},"component":"security_audit","event_type":"security","event":"auth_failed","timestamp":"2025-11-14T19:45:52.135Z","request_id":"1e0eea57-5e13-4e23-8b15-78d012f2e409","ip":"::ffff:127.0.0.1","portfolio_id":"bf-progressive-23e4adec-b6fd-411a-9b27-d7134757e899","reason":"invalid_key","blocked":false,"attempts":2,"remaining_attempts":1,"retry_after_seconds":null}
{"level":40,"time":1763149552135,"pid":13284,"hostname":"i5-12600","req":{"id":"1e0eea57-5e13-4e23-8b15-78d012f2e409","method":"GET","url":"/api/portfolio/bf-progressive-23e4adec-b6fd-411a-9b27-d7134757e899","query":{},"params":{},"headers":{"host":"127.0.0.1:47983","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47984},"error":"Invalid portfolio key.","code":"INVALID_KEY","status":403,"msg":"request_error"}
{"level":30,"time":1763149552137,"pid":13284,"hostname":"i5-12600","req":{"id":"1e0eea57-5e13-4e23-8b15-78d012f2e409","method":"GET","url":"/api/portfolio/bf-progressive-23e4adec-b6fd-411a-9b27-d7134757e899","query":{},"params":{},"headers":{"host":"127.0.0.1:47983","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47984},"res":{"statusCode":403,"headers":{"x-request-id":"1e0eea57-5e13-4e23-8b15-78d012f2e409","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"17","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"93","etag":"W/\"5d-RTDrvLGkJFk4Wf6g751GoYZliLE\""}},"responseTime":3,"msg":"request_complete"}
{"level":30,"time":1763149552147,"pid":13284,"hostname":"i5-12600","req":{"id":"3c0d7f90-50ee-4fc8-b396-18180a65b28a","method":"GET","url":"/api/portfolio/bf-progressive-23e4adec-b6fd-411a-9b27-d7134757e899","query":{},"params":{},"headers":{"host":"127.0.0.1:47985","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47986},"component":"security_audit","event_type":"security","event":"auth_failed","timestamp":"2025-11-14T19:45:52.147Z","request_id":"3c0d7f90-50ee-4fc8-b396-18180a65b28a","ip":"::ffff:127.0.0.1","portfolio_id":"bf-progressive-23e4adec-b6fd-411a-9b27-d7134757e899","reason":"invalid_key","blocked":true,"attempts":3,"remaining_attempts":null,"retry_after_seconds":1}
{"level":40,"time":1763149552147,"pid":13284,"hostname":"i5-12600","req":{"id":"3c0d7f90-50ee-4fc8-b396-18180a65b28a","method":"GET","url":"/api/portfolio/bf-progressive-23e4adec-b6fd-411a-9b27-d7134757e899","query":{},"params":{},"headers":{"host":"127.0.0.1:47985","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47986},"error":"Too many invalid portfolio key attempts. Try again later.","code":"TOO_MANY_KEY_ATTEMPTS","status":429,"msg":"request_error"}
{"level":30,"time":1763149552148,"pid":13284,"hostname":"i5-12600","req":{"id":"3c0d7f90-50ee-4fc8-b396-18180a65b28a","method":"GET","url":"/api/portfolio/bf-progressive-23e4adec-b6fd-411a-9b27-d7134757e899","query":{},"params":{},"headers":{"host":"127.0.0.1:47985","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47986},"res":{"statusCode":429,"headers":{"x-request-id":"3c0d7f90-50ee-4fc8-b396-18180a65b28a","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"16","ratelimit-reset":"60","retry-after":"1","content-type":"application/json; charset=utf-8","content-length":"103","etag":"W/\"67-I3qYWO1Ta4yFxmvaMkJJHkDFSp4\""}},"responseTime":3,"msg":"request_complete"}
{"level":30,"time":1763149553271,"pid":13284,"hostname":"i5-12600","req":{"id":"c194c351-b99c-4e60-a5f7-ced771db2331","method":"GET","url":"/api/portfolio/bf-progressive-23e4adec-b6fd-411a-9b27-d7134757e899","query":{},"params":{},"headers":{"host":"127.0.0.1:48061","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48062},"component":"security_audit","event_type":"security","event":"auth_success","timestamp":"2025-11-14T19:45:53.271Z","request_id":"c194c351-b99c-4e60-a5f7-ced771db2331","ip":"::ffff:127.0.0.1","portfolio_id":"bf-progressive-23e4adec-b6fd-411a-9b27-d7134757e899","mode":"access"}
{"level":30,"time":1763149553277,"pid":13284,"hostname":"i5-12600","req":{"id":"c194c351-b99c-4e60-a5f7-ced771db2331","method":"GET","url":"/api/portfolio/bf-progressive-23e4adec-b6fd-411a-9b27-d7134757e899","query":{},"params":{},"headers":{"host":"127.0.0.1:48061","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48062},"res":{"statusCode":200,"headers":{"x-request-id":"c194c351-b99c-4e60-a5f7-ced771db2331","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"15","ratelimit-reset":"59","content-type":"application/json; charset=utf-8","content-length":"135","etag":"W/\"87-rKvhb1l54tIElzSP2SLCMvrkOBA\""}},"responseTime":7,"msg":"request_complete"}
{"level":30,"time":1763149553290,"pid":13284,"hostname":"i5-12600","req":{"id":"01f246b2-c199-44c3-81e4-8ffeb79d7bb7","method":"GET","url":"/api/portfolio/bf-progressive-23e4adec-b6fd-411a-9b27-d7134757e899","query":{},"params":{},"headers":{"host":"127.0.0.1:48065","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48066},"component":"security_audit","event_type":"security","event":"auth_failed","timestamp":"2025-11-14T19:45:53.290Z","request_id":"01f246b2-c199-44c3-81e4-8ffeb79d7bb7","ip":"::ffff:127.0.0.1","portfolio_id":"bf-progressive-23e4adec-b6fd-411a-9b27-d7134757e899","reason":"invalid_key","blocked":false,"attempts":1,"remaining_attempts":2,"retry_after_seconds":null}
{"level":40,"time":1763149553291,"pid":13284,"hostname":"i5-12600","req":{"id":"01f246b2-c199-44c3-81e4-8ffeb79d7bb7","method":"GET","url":"/api/portfolio/bf-progressive-23e4adec-b6fd-411a-9b27-d7134757e899","query":{},"params":{},"headers":{"host":"127.0.0.1:48065","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48066},"error":"Invalid portfolio key.","code":"INVALID_KEY","status":403,"msg":"request_error"}
{"level":30,"time":1763149553292,"pid":13284,"hostname":"i5-12600","req":{"id":"01f246b2-c199-44c3-81e4-8ffeb79d7bb7","method":"GET","url":"/api/portfolio/bf-progressive-23e4adec-b6fd-411a-9b27-d7134757e899","query":{},"params":{},"headers":{"host":"127.0.0.1:48065","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48066},"res":{"statusCode":403,"headers":{"x-request-id":"01f246b2-c199-44c3-81e4-8ffeb79d7bb7","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"14","ratelimit-reset":"59","content-type":"application/json; charset=utf-8","content-length":"93","etag":"W/\"5d-ELcfWRGClygcgbKqalSEh8giJgw\""}},"responseTime":5,"msg":"request_complete"}
{"level":30,"time":1763149553305,"pid":13284,"hostname":"i5-12600","req":{"id":"9a5ab566-0615-4768-aa60-4c7f403d22f1","method":"GET","url":"/api/portfolio/bf-progressive-23e4adec-b6fd-411a-9b27-d7134757e899","query":{},"params":{},"headers":{"host":"127.0.0.1:48067","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48068},"component":"security_audit","event_type":"security","event":"auth_failed","timestamp":"2025-11-14T19:45:53.305Z","request_id":"9a5ab566-0615-4768-aa60-4c7f403d22f1","ip":"::ffff:127.0.0.1","portfolio_id":"bf-progressive-23e4adec-b6fd-411a-9b27-d7134757e899","reason":"invalid_key","blocked":false,"attempts":2,"remaining_attempts":1,"retry_after_seconds":null}
{"level":40,"time":1763149553306,"pid":13284,"hostname":"i5-12600","req":{"id":"9a5ab566-0615-4768-aa60-4c7f403d22f1","method":"GET","url":"/api/portfolio/bf-progressive-23e4adec-b6fd-411a-9b27-d7134757e899","query":{},"params":{},"headers":{"host":"127.0.0.1:48067","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48068},"error":"Invalid portfolio key.","code":"INVALID_KEY","status":403,"msg":"request_error"}
{"level":30,"time":1763149553307,"pid":13284,"hostname":"i5-12600","req":{"id":"9a5ab566-0615-4768-aa60-4c7f403d22f1","method":"GET","url":"/api/portfolio/bf-progressive-23e4adec-b6fd-411a-9b27-d7134757e899","query":{},"params":{},"headers":{"host":"127.0.0.1:48067","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48068},"res":{"statusCode":403,"headers":{"x-request-id":"9a5ab566-0615-4768-aa60-4c7f403d22f1","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"13","ratelimit-reset":"59","content-type":"application/json; charset=utf-8","content-length":"93","etag":"W/\"5d-RTDrvLGkJFk4Wf6g751GoYZliLE\""}},"responseTime":4,"msg":"request_complete"}
{"level":30,"time":1763149553318,"pid":13284,"hostname":"i5-12600","req":{"id":"7d603b57-1b3b-44b8-86c9-402ee2fc5b51","method":"GET","url":"/api/portfolio/bf-progressive-23e4adec-b6fd-411a-9b27-d7134757e899","query":{},"params":{},"headers":{"host":"127.0.0.1:48069","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48071},"component":"security_audit","event_type":"security","event":"auth_failed","timestamp":"2025-11-14T19:45:53.318Z","request_id":"7d603b57-1b3b-44b8-86c9-402ee2fc5b51","ip":"::ffff:127.0.0.1","portfolio_id":"bf-progressive-23e4adec-b6fd-411a-9b27-d7134757e899","reason":"invalid_key","blocked":true,"attempts":3,"remaining_attempts":null,"retry_after_seconds":1}
{"level":40,"time":1763149553319,"pid":13284,"hostname":"i5-12600","req":{"id":"7d603b57-1b3b-44b8-86c9-402ee2fc5b51","method":"GET","url":"/api/portfolio/bf-progressive-23e4adec-b6fd-411a-9b27-d7134757e899","query":{},"params":{},"headers":{"host":"127.0.0.1:48069","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48071},"error":"Too many invalid portfolio key attempts. Try again later.","code":"TOO_MANY_KEY_ATTEMPTS","status":429,"msg":"request_error"}
{"level":30,"time":1763149553320,"pid":13284,"hostname":"i5-12600","req":{"id":"7d603b57-1b3b-44b8-86c9-402ee2fc5b51","method":"GET","url":"/api/portfolio/bf-progressive-23e4adec-b6fd-411a-9b27-d7134757e899","query":{},"params":{},"headers":{"host":"127.0.0.1:48069","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48071},"res":{"statusCode":429,"headers":{"x-request-id":"7d603b57-1b3b-44b8-86c9-402ee2fc5b51","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"12","ratelimit-reset":"59","retry-after":"1","content-type":"application/json; charset=utf-8","content-length":"103","etag":"W/\"67-I3qYWO1Ta4yFxmvaMkJJHkDFSp4\""}},"responseTime":3,"msg":"request_complete"}
✔ lockout duration increases progressively (1531.21ms)
{"level":30,"time":1763149553570,"pid":13284,"hostname":"i5-12600","req":{"id":"27ef67b4-6770-4099-b495-69c2941474e5","method":"POST","url":"/api/portfolio/bf-stats-0b348d73-4fb9-4fe5-be70-d9f748238cd1","query":{},"params":{},"headers":{"host":"127.0.0.1:48073","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","content-type":"application/json","content-length":"32","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48074},"component":"security_audit","event_type":"security","event":"auth_success","timestamp":"2025-11-14T19:45:53.569Z","request_id":"27ef67b4-6770-4099-b495-69c2941474e5","ip":"::ffff:127.0.0.1","portfolio_id":"bf-stats-0b348d73-4fb9-4fe5-be70-d9f748238cd1","mode":"bootstrap"}
{"level":30,"time":1763149553582,"pid":13284,"hostname":"i5-12600","req":{"id":"27ef67b4-6770-4099-b495-69c2941474e5","method":"POST","url":"/api/portfolio/bf-stats-0b348d73-4fb9-4fe5-be70-d9f748238cd1","query":{},"params":{},"headers":{"host":"127.0.0.1:48073","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","content-type":"application/json","content-length":"32","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48074},"res":{"statusCode":200,"headers":{"x-request-id":"27ef67b4-6770-4099-b495-69c2941474e5","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"19","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"15","etag":"W/\"f-VaSQ4oDUiZblZNAEkkN+sX+q3Sg\""}},"responseTime":240,"msg":"request_complete"}
{"level":30,"time":1763149553587,"pid":13284,"hostname":"i5-12600","req":{"id":"84c5bd20-eef0-480f-86a9-86e60865cbdf","method":"GET","url":"/api/portfolio/bf-stats-0b348d73-4fb9-4fe5-be70-d9f748238cd1","query":{},"params":{},"headers":{"host":"127.0.0.1:48082","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48084},"component":"security_audit","event_type":"security","event":"auth_failed","timestamp":"2025-11-14T19:45:53.587Z","request_id":"84c5bd20-eef0-480f-86a9-86e60865cbdf","ip":"::ffff:127.0.0.1","portfolio_id":"bf-stats-0b348d73-4fb9-4fe5-be70-d9f748238cd1","reason":"invalid_key","blocked":false,"attempts":1,"remaining_attempts":1,"retry_after_seconds":null}
{"level":40,"time":1763149553587,"pid":13284,"hostname":"i5-12600","req":{"id":"84c5bd20-eef0-480f-86a9-86e60865cbdf","method":"GET","url":"/api/portfolio/bf-stats-0b348d73-4fb9-4fe5-be70-d9f748238cd1","query":{},"params":{},"headers":{"host":"127.0.0.1:48082","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48084},"error":"Invalid portfolio key.","code":"INVALID_KEY","status":403,"msg":"request_error"}
{"level":30,"time":1763149553587,"pid":13284,"hostname":"i5-12600","req":{"id":"84c5bd20-eef0-480f-86a9-86e60865cbdf","method":"GET","url":"/api/portfolio/bf-stats-0b348d73-4fb9-4fe5-be70-d9f748238cd1","query":{},"params":{},"headers":{"host":"127.0.0.1:48082","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48084},"res":{"statusCode":403,"headers":{"x-request-id":"84c5bd20-eef0-480f-86a9-86e60865cbdf","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"18","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"93","etag":"W/\"5d-RTDrvLGkJFk4Wf6g751GoYZliLE\""}},"responseTime":1,"msg":"request_complete"}
{"level":30,"time":1763149553593,"pid":13284,"hostname":"i5-12600","req":{"id":"1f9a7d66-2ace-424c-8484-cdaa6828d680","method":"GET","url":"/api/portfolio/bf-stats-0b348d73-4fb9-4fe5-be70-d9f748238cd1","query":{},"params":{},"headers":{"host":"127.0.0.1:48085","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48086},"component":"security_audit","event_type":"security","event":"auth_failed","timestamp":"2025-11-14T19:45:53.593Z","request_id":"1f9a7d66-2ace-424c-8484-cdaa6828d680","ip":"::ffff:127.0.0.1","portfolio_id":"bf-stats-0b348d73-4fb9-4fe5-be70-d9f748238cd1","reason":"invalid_key","blocked":true,"attempts":2,"remaining_attempts":null,"retry_after_seconds":1}
{"level":40,"time":1763149553594,"pid":13284,"hostname":"i5-12600","req":{"id":"1f9a7d66-2ace-424c-8484-cdaa6828d680","method":"GET","url":"/api/portfolio/bf-stats-0b348d73-4fb9-4fe5-be70-d9f748238cd1","query":{},"params":{},"headers":{"host":"127.0.0.1:48085","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48086},"error":"Too many invalid portfolio key attempts. Try again later.","code":"TOO_MANY_KEY_ATTEMPTS","status":429,"msg":"request_error"}
{"level":30,"time":1763149553594,"pid":13284,"hostname":"i5-12600","req":{"id":"1f9a7d66-2ace-424c-8484-cdaa6828d680","method":"GET","url":"/api/portfolio/bf-stats-0b348d73-4fb9-4fe5-be70-d9f748238cd1","query":{},"params":{},"headers":{"host":"127.0.0.1:48085","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48086},"res":{"statusCode":429,"headers":{"x-request-id":"1f9a7d66-2ace-424c-8484-cdaa6828d680","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"17","ratelimit-reset":"60","retry-after":"1","content-type":"application/json; charset=utf-8","content-length":"103","etag":"W/\"67-I3qYWO1Ta4yFxmvaMkJJHkDFSp4\""}},"responseTime":1,"msg":"request_complete"}
{"level":30,"time":1763149553602,"pid":13284,"hostname":"i5-12600","req":{"id":"3f3193fa-56f2-4b3d-a384-1d17aaf77860","method":"GET","url":"/api/security/stats","query":{},"params":{},"headers":{"host":"127.0.0.1:48087","accept-encoding":"gzip, deflate","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48088},"res":{"statusCode":200,"headers":{"x-request-id":"3f3193fa-56f2-4b3d-a384-1d17aaf77860","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"100;w=60","ratelimit-limit":"100","ratelimit-remaining":"96","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"960","etag":"W/\"3c0-gpvBUT304sOcW9vSk8heBxgGeVk\""}},"responseTime":3,"msg":"request_complete"}
✔ security stats endpoint reports active lockouts (283.5942ms)
{"level":30,"time":1763149551110,"pid":21324,"hostname":"i5-12600","req":{"id":"ed3d2a3c-69a7-44a7-83e4-47b1756f8bdd","method":"GET","url":"/api/prices/MSFT","query":{},"params":{},"headers":{"host":"127.0.0.1:47899","accept-encoding":"gzip, deflate","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47900},"res":{"statusCode":200,"headers":{"x-request-id":"ed3d2a3c-69a7-44a7-83e4-47b1756f8bdd","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"60;w=60","ratelimit-limit":"60","ratelimit-remaining":"59","ratelimit-reset":"60","etag":"09a8d70b83b40d11f63011b9ff7c47a7","cache-control":"private, max-age=450","x-cache":"MISS","content-type":"application/json; charset=utf-8","content-length":"36"}},"responseTime":23,"msg":"request_complete"}
{"level":30,"time":1763149551127,"pid":21324,"hostname":"i5-12600","req":{"id":"bdf6ec8b-8618-476f-bb8b-0885450b738f","method":"GET","url":"/api/prices/MSFT","query":{},"params":{},"headers":{"host":"127.0.0.1:47901","accept-encoding":"gzip, deflate","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47902},"res":{"statusCode":200,"headers":{"x-request-id":"bdf6ec8b-8618-476f-bb8b-0885450b738f","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"60;w=60","ratelimit-limit":"60","ratelimit-remaining":"58","ratelimit-reset":"60","etag":"09a8d70b83b40d11f63011b9ff7c47a7","cache-control":"private, max-age=450","x-cache":"HIT","content-type":"application/json; charset=utf-8","content-length":"36"}},"responseTime":2,"msg":"request_complete"}
✔ GET /api/prices/:symbol caches responses for warm hits and exposes TTL header (94.843ms)
{"level":30,"time":1763149551450,"pid":21324,"hostname":"i5-12600","req":{"id":"0992b9a4-2643-4eaf-a918-36481b4cbd09","method":"GET","url":"/api/returns/daily","query":{},"params":{},"headers":{"host":"127.0.0.1:47905","accept-encoding":"gzip, deflate","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47906},"res":{"statusCode":200,"headers":{"x-request-id":"0992b9a4-2643-4eaf-a918-36481b4cbd09","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"19","ratelimit-reset":"60","cache-control":"private, max-age=450","etag":"9Od3dLF175dZj57szLU5Ayzx5JNlezwWcQC9v4NDy5Q","content-type":"application/json; charset=utf-8","content-length":"321"}},"responseTime":278,"msg":"request_complete"}
{"level":30,"time":1763149551495,"pid":21324,"hostname":"i5-12600","req":{"id":"0355b8f3-2e3a-40b2-be9b-09cbf71d619f","method":"GET","url":"/api/returns/daily","query":{},"params":{},"headers":{"host":"127.0.0.1:47939","accept-encoding":"gzip, deflate","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47940},"res":{"statusCode":200,"headers":{"x-request-id":"0355b8f3-2e3a-40b2-be9b-09cbf71d619f","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"18","ratelimit-reset":"60","cache-control":"private, max-age=450","etag":"9Od3dLF175dZj57szLU5Ayzx5JNlezwWcQC9v4NDy5Q","content-type":"application/json; charset=utf-8","content-length":"321"}},"responseTime":4,"msg":"request_complete"}
✔ GET /api/returns/daily serves cached payloads even when storage mutates (374.3243ms)
{"level":30,"time":1763149551794,"pid":21324,"hostname":"i5-12600","req":{"id":"4b33cbb2-d1b9-4e6d-a3cf-4169045df28b","method":"GET","url":"/api/returns/daily","query":{},"params":{},"headers":{"host":"127.0.0.1:47941","accept-encoding":"gzip, deflate","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47942},"res":{"statusCode":200,"headers":{"x-request-id":"4b33cbb2-d1b9-4e6d-a3cf-4169045df28b","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"19","ratelimit-reset":"60","cache-control":"private, max-age=450","etag":"hKP5L4aRXySTw9jc8CCA7FIfl9chlbVq_mtk-pYonHg","content-type":"application/json; charset=utf-8","content-length":"321"}},"responseTime":256,"msg":"request_complete"}
{"level":30,"time":1763149551805,"pid":21324,"hostname":"i5-12600","req":{"id":"724c0a6a-0312-4bee-b937-a83183547873","method":"GET","url":"/api/returns/daily","query":{},"params":{},"headers":{"host":"127.0.0.1:47959","accept-encoding":"gzip, deflate","if-none-match":"hKP5L4aRXySTw9jc8CCA7FIfl9chlbVq_mtk-pYonHg","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47960},"res":{"statusCode":304,"headers":{"x-request-id":"724c0a6a-0312-4bee-b937-a83183547873","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"18","ratelimit-reset":"60","cache-control":"private, max-age=450","etag":"hKP5L4aRXySTw9jc8CCA7FIfl9chlbVq_mtk-pYonHg"}},"responseTime":4,"msg":"request_complete"}
✔ GET /api/returns/daily negotiates 304 when If-None-Match matches cached ETag (310.3652ms)
{"level":30,"time":1763149552070,"pid":21324,"hostname":"i5-12600","req":{"id":"97dabbc9-5b2b-44ab-bcb2-9106278745bb","method":"GET","url":"/api/returns/daily","query":{},"params":{},"headers":{"host":"127.0.0.1:47965","accept-encoding":"gzip, deflate","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47966},"res":{"statusCode":200,"headers":{"x-request-id":"97dabbc9-5b2b-44ab-bcb2-9106278745bb","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"19","ratelimit-reset":"60","cache-control":"private, max-age=450","etag":"ZGWnQm7MZmGyVaC_mHyV2oZqgPpjKWSiX5MZxeaSLLs","content-type":"application/json; charset=utf-8","content-length":"320"}},"responseTime":225,"msg":"request_complete"}
{"level":30,"time":1763149552107,"pid":21324,"hostname":"i5-12600","req":{"id":"a4c241bb-5fe0-496c-a078-06cf22a8f483","method":"GET","url":"/api/returns/daily","query":{},"params":{},"headers":{"host":"127.0.0.1:47975","accept-encoding":"gzip, deflate","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47976},"res":{"statusCode":200,"headers":{"x-request-id":"a4c241bb-5fe0-496c-a078-06cf22a8f483","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"18","ratelimit-reset":"60","cache-control":"private, max-age=450","etag":"ZGWnQm7MZmGyVaC_mHyV2oZqgPpjKWSiX5MZxeaSLLs","content-type":"application/json; charset=utf-8","content-length":"320"}},"responseTime":11,"msg":"request_complete"}
{"level":30,"time":1763149552161,"pid":21324,"hostname":"i5-12600","req":{"id":"1baf5f3c-be93-407c-8df3-20fd93f63246","method":"POST","url":"/api/portfolio/cache-test","query":{},"params":{},"headers":{"host":"127.0.0.1:47980","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","content-type":"application/json","content-length":"105","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47982},"component":"security_audit","event_type":"security","event":"auth_success","timestamp":"2025-11-14T19:45:52.161Z","request_id":"1baf5f3c-be93-407c-8df3-20fd93f63246","ip":"::ffff:127.0.0.1","portfolio_id":"cache-test","mode":"bootstrap"}
{"level":30,"time":1763149552175,"pid":21324,"hostname":"i5-12600","req":{"id":"1baf5f3c-be93-407c-8df3-20fd93f63246","method":"POST","url":"/api/portfolio/cache-test","query":{},"params":{},"headers":{"host":"127.0.0.1:47980","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","content-type":"application/json","content-length":"105","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47982},"res":{"statusCode":200,"headers":{"x-request-id":"1baf5f3c-be93-407c-8df3-20fd93f63246","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"17","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"15","etag":"W/\"f-VaSQ4oDUiZblZNAEkkN+sX+q3Sg\""}},"responseTime":59,"msg":"request_complete"}
{"level":30,"time":1763149552183,"pid":21324,"hostname":"i5-12600","req":{"id":"3cd902a0-8b86-4d07-8e88-83a2b0c56271","method":"GET","url":"/api/returns/daily","query":{},"params":{},"headers":{"host":"127.0.0.1:47987","accept-encoding":"gzip, deflate","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47988},"res":{"statusCode":200,"headers":{"x-request-id":"3cd902a0-8b86-4d07-8e88-83a2b0c56271","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"16","ratelimit-reset":"60","cache-control":"private, max-age=450","etag":"HMhJWOyTMbjgXDWG4IysEKNejQMuGf3nJJJ4sKHtsmo","content-type":"application/json; charset=utf-8","content-length":"319"}},"responseTime":3,"msg":"request_complete"}
✔ POST /api/portfolio/:id flushes cached analytics responses (376.6752ms)
✔ isTradingDay returns false for weekends and true for weekdays (5.217ms)
✔ isTradingDay covers observed US market holidays (0.4234ms)
✔ computeTradingDayAge skips weekends and holidays (0.3575ms)
✔ nextTradingDay advances over consecutive non-trading days (0.331ms)
✔ accrueInterest posts deterministic interest for random balances (5324.4082ms)
✖ accrueInterest remains idempotent under repeated execution (2461.2544ms)
﹣ monthly posting matches cumulative daily interest within one cent (0.6842ms) # SKIP
✔ dailyRateFromApy matches expected precision (63.4076ms)
✔ toDateKey normalizes timestamps into UTC date strings (56.3258ms)
✔ postInterestForDate produces deterministic interest across scenarios (51.1012ms)
✔ postInterestForDate skips dates where interest already exists (38.7175ms)
✔ resolveApyForDate returns latest effective rate (40.4617ms)
✔ accrueInterest inserts transaction when balance positive (55.1332ms)
✔ accrueInterest is idempotent across reruns (47.9661ms)
✖ monthly interest accrual buffers and posts once per month (55.1208ms)
✔ monthly interest accrual respects portfolio boundaries and policies (63.4875ms)
✔ accrueInterest respects custom day count conventions (62.3058ms)
{"level":30,"time":1763149551236,"pid":4112,"hostname":"i5-12600","req":{"id":"3ab204ff-8c1c-4130-ba92-6204f6b7ec9a","method":"GET","url":"/api/prices/BIG?range=1y","query":{"range":"1y"},"params":{},"headers":{"host":"127.0.0.1:47903","accept-encoding":"gzip","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47904},"res":{"statusCode":200,"headers":{"x-request-id":"3ab204ff-8c1c-4130-ba92-6204f6b7ec9a","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"60;w=60","ratelimit-limit":"60","ratelimit-remaining":"59","ratelimit-reset":"60","etag":"abb294fddf908bb129d591f0a55e34ba","cache-control":"private, max-age=600","x-cache":"MISS","content-type":"application/json; charset=utf-8","content-encoding":"gzip"}},"responseTime":57,"msg":"request_complete"}
✔ gzip compression is applied to large JSON responses (125.6172ms)
{"level":30,"time":1763149551276,"pid":4112,"hostname":"i5-12600","req":{"id":"2b544b65-7b9c-4d91-b752-bf18103c0fef","method":"GET","url":"/api/prices/SKIP?range=1y","query":{"range":"1y"},"params":{},"headers":{"host":"127.0.0.1:47919","accept-encoding":"gzip","x-no-compression":"1","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47920},"res":{"statusCode":200,"headers":{"x-request-id":"2b544b65-7b9c-4d91-b752-bf18103c0fef","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin","ratelimit-policy":"60;w=60","ratelimit-limit":"60","ratelimit-remaining":"59","ratelimit-reset":"60","etag":"abb294fddf908bb129d591f0a55e34ba","cache-control":"private, max-age=600","x-cache":"MISS","content-type":"application/json; charset=utf-8","content-length":"69101"}},"responseTime":9,"msg":"request_complete"}
✔ compression can be skipped with x-no-compression header (24.8841ms)
{"level":30,"time":1763149551296,"pid":4112,"hostname":"i5-12600","req":{"id":"db5ddf17-4c37-45f3-8c5c-338a7ef743e2","method":"GET","url":"/api/security/stats","query":{},"params":{},"headers":{"host":"127.0.0.1:47923","accept-encoding":"gzip, deflate","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47924},"res":{"statusCode":200,"headers":{"x-request-id":"db5ddf17-4c37-45f3-8c5c-338a7ef743e2","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"100;w=60","ratelimit-limit":"100","ratelimit-remaining":"99","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"798","etag":"W/\"31e-WD6tDO6S8vRiG3KhDswYjf6qPd0\""}},"responseTime":3,"msg":"request_complete"}
✔ small responses remain uncompressed (17.1393ms)
▶ sanitizeCsvCell
  ✔ returns empty string for nullish values (1.1508ms)
  ✔ prefixes risky leading characters with a quote (0.232ms)
  ✔ returns unchanged strings without risky prefixes (0.1619ms)
✔ sanitizeCsvCell (3.0497ms)
✔ runDailyClose accrues interest and is idempotent (454.8669ms)
✔ runDailyClose posts a single monthly interest entry when enabled (441.4143ms)
{"level":30,"time":1763149552470,"pid":18116,"hostname":"i5-12600","req":{"id":"8fd122a3-9eb9-4011-9ef5-5cb8d33fae1a","method":"GET","url":"/api/returns/daily?from=2024-01-01&to=2024-01-02&views=port,bench","query":{"from":"2024-01-01","to":"2024-01-02","views":"port,bench"},"params":{},"headers":{"host":"127.0.0.1:48003","accept-encoding":"gzip, deflate","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48006},"res":{"statusCode":200,"headers":{"x-request-id":"8fd122a3-9eb9-4011-9ef5-5cb8d33fae1a","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"19","ratelimit-reset":"60","cache-control":"private, max-age=600","etag":"dtYgKQlbZHoQl8-jD7UYmVsbccgeCKMRGHQZAOTrYgw","content-type":"application/json; charset=utf-8","content-length":"224"}},"responseTime":31,"msg":"request_complete"}
{"level":30,"time":1763149552491,"pid":18116,"hostname":"i5-12600","req":{"id":"3776ce03-b666-4960-af06-cfb9c6f94d7a","method":"GET","url":"/api/nav/daily?from=2024-01-02&to=2024-01-02","query":{"from":"2024-01-02","to":"2024-01-02"},"params":{},"headers":{"host":"127.0.0.1:48013","accept-encoding":"gzip, deflate","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48014},"res":{"statusCode":200,"headers":{"x-request-id":"3776ce03-b666-4960-af06-cfb9c6f94d7a","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"18","ratelimit-reset":"60","cache-control":"private, max-age=600","etag":"KXWA40kal5lX62cCuOPmcXtA7vsW_dh8SYWwjJGT-Vc","content-type":"application/json; charset=utf-8","content-length":"224"}},"responseTime":7,"msg":"request_complete"}
{"level":30,"time":1763149552510,"pid":18116,"hostname":"i5-12600","req":{"id":"6669df16-94f3-4065-9dd8-42719e22b7f1","method":"GET","url":"/api/benchmarks/summary?from=2024-01-01&to=2024-01-02","query":{"from":"2024-01-01","to":"2024-01-02"},"params":{},"headers":{"host":"127.0.0.1:48017","accept-encoding":"gzip, deflate","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48018},"res":{"statusCode":200,"headers":{"x-request-id":"6669df16-94f3-4065-9dd8-42719e22b7f1","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"100;w=60","ratelimit-limit":"100","ratelimit-remaining":"97","ratelimit-reset":"60","cache-control":"private, max-age=600","etag":"Dw_o26c-AZBqNxeiNZqFBkqyMXRqf0hZEebg99y42Wo","content-type":"application/json; charset=utf-8","content-length":"247"}},"responseTime":9,"msg":"request_complete"}
{"level":30,"time":1763149552555,"pid":18116,"hostname":"i5-12600","req":{"id":"3fc0a2d5-2946-4add-929b-77037066a3a9","method":"POST","url":"/api/admin/cash-rate","query":{},"params":{},"headers":{"host":"127.0.0.1:48019","accept-encoding":"gzip, deflate","content-type":"application/json","content-length":"42","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48021},"res":{"statusCode":200,"headers":{"x-request-id":"3fc0a2d5-2946-4add-929b-77037066a3a9","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"100;w=60","ratelimit-limit":"100","ratelimit-remaining":"96","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"15","etag":"W/\"f-VaSQ4oDUiZblZNAEkkN+sX+q3Sg\""}},"responseTime":38,"msg":"request_complete"}
✔ API endpoints expose computed series (519.0307ms)
✔ stale prices set flag when latest close missing (309.5351ms)
✔ toCents and fromCents round-trip to the nearest cent (3.2983ms)
✔ micro-share conversions preserve six decimal places (0.5866ms)
✔ random cent conversions remain stable across repeated round-trips (4.1174ms)
✔ computeDailyStates handles same-day ordering without negative cash (13.9415ms)
{"level":30,"time":1763149551525,"pid":14908,"hostname":"i5-12600","req":{"id":"c658745a-fe59-436e-8dea-90227924aea6","method":"POST","url":"/api/portfolio/edge-oversell-fc94a9f6-5072-49ea-a40b-a6d994620874","query":{},"params":{},"headers":{"host":"127.0.0.1:47908","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","content-type":"application/json","content-length":"228","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47911},"component":"security_audit","event_type":"security","event":"auth_success","timestamp":"2025-11-14T19:45:51.524Z","request_id":"c658745a-fe59-436e-8dea-90227924aea6","ip":"::ffff:127.0.0.1","portfolio_id":"edge-oversell-fc94a9f6-5072-49ea-a40b-a6d994620874","mode":"bootstrap"}
{"level":40,"time":1763149551532,"pid":14908,"hostname":"i5-12600","req":{"id":"c658745a-fe59-436e-8dea-90227924aea6","method":"POST","url":"/api/portfolio/edge-oversell-fc94a9f6-5072-49ea-a40b-a6d994620874","query":{},"params":{},"headers":{"host":"127.0.0.1:47908","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","content-type":"application/json","content-length":"228","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47911},"error":"Cash balance cannot go negative. Deficit of 1000.00 detected.","code":"E_CASH_OVERDRAW","status":400,"msg":"request_error"}
{"level":30,"time":1763149551537,"pid":14908,"hostname":"i5-12600","req":{"id":"c658745a-fe59-436e-8dea-90227924aea6","method":"POST","url":"/api/portfolio/edge-oversell-fc94a9f6-5072-49ea-a40b-a6d994620874","query":{},"params":{},"headers":{"host":"127.0.0.1:47908","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","content-type":"application/json","content-length":"228","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47911},"res":{"statusCode":400,"headers":{"x-request-id":"c658745a-fe59-436e-8dea-90227924aea6","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"19","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"205","etag":"W/\"cd-gSU10HlgcSLehRVE0K9OM5y1/L4\""}},"responseTime":318,"msg":"request_complete"}
✖ oversell prevention rejects sales beyond available shares (385.8545ms)
{"level":30,"time":1763149551879,"pid":14908,"hostname":"i5-12600","req":{"id":"7413cc53-1db4-4e7d-bc97-c94da203863a","method":"POST","url":"/api/portfolio/edge-cash-9962b5ee-7014-4b2b-9974-31b58a3b4ce5","query":{},"params":{},"headers":{"host":"127.0.0.1:47947","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","content-type":"application/json","content-length":"155","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47948},"component":"security_audit","event_type":"security","event":"auth_success","timestamp":"2025-11-14T19:45:51.879Z","request_id":"7413cc53-1db4-4e7d-bc97-c94da203863a","ip":"::ffff:127.0.0.1","portfolio_id":"edge-cash-9962b5ee-7014-4b2b-9974-31b58a3b4ce5","mode":"bootstrap"}
{"level":40,"time":1763149551881,"pid":14908,"hostname":"i5-12600","req":{"id":"7413cc53-1db4-4e7d-bc97-c94da203863a","method":"POST","url":"/api/portfolio/edge-cash-9962b5ee-7014-4b2b-9974-31b58a3b4ce5","query":{},"params":{},"headers":{"host":"127.0.0.1:47947","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","content-type":"application/json","content-length":"155","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47948},"error":"Cash balance cannot go negative. Deficit of 1.00 detected.","code":"E_CASH_OVERDRAW","status":400,"msg":"request_error"}
{"level":30,"time":1763149551883,"pid":14908,"hostname":"i5-12600","req":{"id":"7413cc53-1db4-4e7d-bc97-c94da203863a","method":"POST","url":"/api/portfolio/edge-cash-9962b5ee-7014-4b2b-9974-31b58a3b4ce5","query":{},"params":{},"headers":{"host":"127.0.0.1:47947","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","content-type":"application/json","content-length":"155","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47948},"res":{"statusCode":400,"headers":{"x-request-id":"7413cc53-1db4-4e7d-bc97-c94da203863a","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"19","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"206","etag":"W/\"ce-shb+ZWJYh/G9B2DX4PkPcw54RVE\""}},"responseTime":310,"msg":"request_complete"}
✔ rejects withdrawals that exceed available cash (338.6357ms)
✔ projectStateUntil preserves fractional precision (1.4004ms)
✔ projectStateUntil handles large transaction volumes deterministically (47.3425ms)
{"level":30,"time":1763149552217,"pid":14908,"hostname":"i5-12600","req":{"id":"1828262c-d0f2-44de-ad68-b02075d779fb","method":"POST","url":"/api/portfolio/edge-validate-d6ac79cf-a352-47a8-baf1-fa0363a93f94","query":{},"params":{},"headers":{"host":"127.0.0.1:47971","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","content-type":"application/json","content-length":"108","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47972},"component":"security_audit","event_type":"security","event":"auth_success","timestamp":"2025-11-14T19:45:52.217Z","request_id":"1828262c-d0f2-44de-ad68-b02075d779fb","ip":"::ffff:127.0.0.1","portfolio_id":"edge-validate-d6ac79cf-a352-47a8-baf1-fa0363a93f94","mode":"bootstrap"}
{"level":40,"time":1763149552219,"pid":14908,"hostname":"i5-12600","req":{"id":"1828262c-d0f2-44de-ad68-b02075d779fb","method":"POST","url":"/api/portfolio/edge-validate-d6ac79cf-a352-47a8-baf1-fa0363a93f94","query":{},"params":{},"headers":{"host":"127.0.0.1:47971","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","content-type":"application/json","content-length":"108","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47972},"error":"Request validation failed.","code":"VALIDATION_ERROR","status":400,"msg":"request_error"}
{"level":30,"time":1763149552220,"pid":14908,"hostname":"i5-12600","req":{"id":"1828262c-d0f2-44de-ad68-b02075d779fb","method":"POST","url":"/api/portfolio/edge-validate-d6ac79cf-a352-47a8-baf1-fa0363a93f94","query":{},"params":{},"headers":{"host":"127.0.0.1:47971","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","content-type":"application/json","content-length":"108","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47972},"res":{"statusCode":400,"headers":{"x-request-id":"1828262c-d0f2-44de-ad68-b02075d779fb","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"19","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"171","etag":"W/\"ab-sFYXLB6/2ud1qlDldD3wkGW7fHs\""}},"responseTime":258,"msg":"request_complete"}
✔ validation rejects negative prices before persistence (288.6379ms)
▶ createSecurityEventStore
  ✔ drops oldest events and clamps returned list size (8.1584ms)
  ✔ normalizes requestId and timestamp inputs without mutating original event (0.6025ms)
  ✔ list clones entries to keep store immutable (0.7689ms)
  ✔ clear removes stored events and resets sequence counter (0.4359ms)
  ✔ ignores events that are not security typed (0.2385ms)
  ✔ falls back to default max events when configuration is invalid (1.7845ms)
✔ createSecurityEventStore (13.9502ms)
{"level":30,"time":1763149552021,"pid":7912,"hostname":"i5-12600","req":{"id":"3e3b553f-9eb8-4943-a86d-1805deb741ee","method":"GET","url":"/api/prices/SPY","query":{},"params":{},"headers":{"host":"127.0.0.1:47969","accept-encoding":"gzip, deflate","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47970},"res":{"statusCode":503,"headers":{"x-request-id":"3e3b553f-9eb8-4943-a86d-1805deb741ee","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"60;w=60","ratelimit-limit":"60","ratelimit-remaining":"59","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"22","etag":"W/\"16-+A3MgsvzYE8dC3AHvwGGeefeaeg\""}},"err":{"type":"Error","message":"failed with status code 503","stack":"Error: failed with status code 503\n    at onResFinished (C:\\Users\\corte\\VS Code Projects\\portfolio-manager-server\\node_modules\\pino-http\\logger.js:115:39)\n    at ServerResponse.onResponseComplete (C:\\Users\\corte\\VS Code Projects\\portfolio-manager-server\\node_modules\\pino-http\\logger.js:178:14)\n    at ServerResponse.emit (node:events:520:35)\n    at onFinish (node:_http_outgoing:1024:10)\n    at callback (node:internal/streams/writable:764:21)\n    at afterWrite (node:internal/streams/writable:708:5)\n    at afterWriteTick (node:internal/streams/writable:694:10)\n    at process.processTicksAndRejections (node:internal/process/task_queues:88:21)"},"responseTime":61,"msg":"request_error"}
✔ prices endpoint returns 503 for stale data (145.4738ms)
{"level":30,"time":1763149552364,"pid":7912,"hostname":"i5-12600","req":{"id":"9fb3c3f7-dd02-4313-b1f3-83efcd1fa7c8","method":"GET","url":"/api/benchmarks/summary","query":{},"params":{},"headers":{"host":"127.0.0.1:47973","accept-encoding":"gzip, deflate","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":47974},"res":{"statusCode":503,"headers":{"x-request-id":"9fb3c3f7-dd02-4313-b1f3-83efcd1fa7c8","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"100;w=60","ratelimit-limit":"100","ratelimit-remaining":"99","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"22","etag":"W/\"16-+A3MgsvzYE8dC3AHvwGGeefeaeg\""}},"err":{"type":"Error","message":"failed with status code 503","stack":"Error: failed with status code 503\n    at onResFinished (C:\\Users\\corte\\VS Code Projects\\portfolio-manager-server\\node_modules\\pino-http\\logger.js:115:39)\n    at ServerResponse.onResponseComplete (C:\\Users\\corte\\VS Code Projects\\portfolio-manager-server\\node_modules\\pino-http\\logger.js:178:14)\n    at ServerResponse.emit (node:events:520:35)\n    at onFinish (node:_http_outgoing:1024:10)\n    at callback (node:internal/streams/writable:764:21)\n    at afterWrite (node:internal/streams/writable:708:5)\n    at afterWriteTick (node:internal/streams/writable:694:10)\n    at process.processTicksAndRejections (node:internal/process/task_queues:88:21)"},"responseTime":287,"msg":"request_error"}
✔ benchmarks summary returns 503 when latest return is stale (343.9516ms)
▶ holdings utilities
  ✔ builds aggregate holdings with realised gains (1.6509ms)
  ✔ derives holding stats and signal rows (21.385ms)
  ✔ computes dashboard metrics (1.3392ms)
  ✔ handles missing tickers and unavailable prices gracefully (0.4364ms)
  ✔ prevents negative shares when selling more than owned (0.512ms)
  ✔ handles floating-point precision in multiple sells (0.3938ms)
✔ holdings utilities (27.6455ms)
✔ HTTP logs redact API key headers (378.7606ms)
{"level":30,"time":1763149553176,"pid":21124,"hostname":"i5-12600","req":{"id":"inbound-trace","method":"POST","url":"/api/portfolio/life-baef854f-51d2-47eb-8b3e-cded728e9c1d","query":{},"params":{},"headers":{"host":"127.0.0.1:48049","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","x-request-id":"inbound-trace","content-type":"application/json","content-length":"32","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48050},"component":"security_audit","event_type":"security","event":"auth_success","timestamp":"2025-11-14T19:45:53.175Z","request_id":"inbound-trace","ip":"::ffff:127.0.0.1","portfolio_id":"life-baef854f-51d2-47eb-8b3e-cded728e9c1d","mode":"bootstrap"}
{"level":30,"time":1763149553195,"pid":21124,"hostname":"i5-12600","req":{"id":"inbound-trace","method":"POST","url":"/api/portfolio/life-baef854f-51d2-47eb-8b3e-cded728e9c1d","query":{},"params":{},"headers":{"host":"127.0.0.1:48049","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","x-request-id":"inbound-trace","content-type":"application/json","content-length":"32","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48050},"res":{"statusCode":200,"headers":{"x-request-id":"inbound-trace","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"19","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"15","etag":"W/\"f-VaSQ4oDUiZblZNAEkkN+sX+q3Sg\""}},"responseTime":347,"msg":"request_complete"}
{"level":30,"time":1763149553208,"pid":21124,"hostname":"i5-12600","req":{"id":"6057b8a9-db64-4c0e-a64d-676e4a3729d5","method":"POST","url":"/api/portfolio/life-baef854f-51d2-47eb-8b3e-cded728e9c1d","query":{},"params":{},"headers":{"host":"127.0.0.1:48053","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","content-type":"application/json","content-length":"218","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48054},"component":"security_audit","event_type":"security","event":"auth_success","timestamp":"2025-11-14T19:45:53.208Z","request_id":"6057b8a9-db64-4c0e-a64d-676e4a3729d5","ip":"::ffff:127.0.0.1","portfolio_id":"life-baef854f-51d2-47eb-8b3e-cded728e9c1d","mode":"access"}
{"level":30,"time":1763149553230,"pid":21124,"hostname":"i5-12600","req":{"id":"6057b8a9-db64-4c0e-a64d-676e4a3729d5","method":"POST","url":"/api/portfolio/life-baef854f-51d2-47eb-8b3e-cded728e9c1d","query":{},"params":{},"headers":{"host":"127.0.0.1:48053","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","content-type":"application/json","content-length":"218","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48054},"res":{"statusCode":200,"headers":{"x-request-id":"6057b8a9-db64-4c0e-a64d-676e4a3729d5","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"18","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"15","etag":"W/\"f-VaSQ4oDUiZblZNAEkkN+sX+q3Sg\""}},"responseTime":24,"msg":"request_complete"}
{"level":30,"time":1763149553237,"pid":21124,"hostname":"i5-12600","req":{"id":"10c48482-daed-4533-94ed-8d7c9112bd84","method":"GET","url":"/api/portfolio/life-baef854f-51d2-47eb-8b3e-cded728e9c1d","query":{},"params":{},"headers":{"host":"127.0.0.1:48055","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48056},"component":"security_audit","event_type":"security","event":"auth_success","timestamp":"2025-11-14T19:45:53.237Z","request_id":"10c48482-daed-4533-94ed-8d7c9112bd84","ip":"::ffff:127.0.0.1","portfolio_id":"life-baef854f-51d2-47eb-8b3e-cded728e9c1d","mode":"access"}
{"level":30,"time":1763149553239,"pid":21124,"hostname":"i5-12600","req":{"id":"10c48482-daed-4533-94ed-8d7c9112bd84","method":"GET","url":"/api/portfolio/life-baef854f-51d2-47eb-8b3e-cded728e9c1d","query":{},"params":{},"headers":{"host":"127.0.0.1:48055","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48056},"res":{"statusCode":200,"headers":{"x-request-id":"10c48482-daed-4533-94ed-8d7c9112bd84","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"17","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"475","etag":"W/\"1db-3MP31M0iNhj3kRsY1aFjv1nmyWA\""}},"responseTime":3,"msg":"request_complete"}
{"level":30,"time":1763149553246,"pid":21124,"hostname":"i5-12600","req":{"id":"e0e2edcc-999f-4269-957f-6113f575071e","method":"POST","url":"/api/portfolio/life-baef854f-51d2-47eb-8b3e-cded728e9c1d","query":{},"params":{},"headers":{"host":"127.0.0.1:48057","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","x-portfolio-key-new":"[REDACTED]","content-type":"application/json","content-length":"218","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48058},"component":"security_audit","event_type":"security","event":"key_rotated","timestamp":"2025-11-14T19:45:53.246Z","request_id":"e0e2edcc-999f-4269-957f-6113f575071e","ip":"::ffff:127.0.0.1","portfolio_id":"life-baef854f-51d2-47eb-8b3e-cded728e9c1d"}
{"level":30,"time":1763149553247,"pid":21124,"hostname":"i5-12600","req":{"id":"e0e2edcc-999f-4269-957f-6113f575071e","method":"POST","url":"/api/portfolio/life-baef854f-51d2-47eb-8b3e-cded728e9c1d","query":{},"params":{},"headers":{"host":"127.0.0.1:48057","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","x-portfolio-key-new":"[REDACTED]","content-type":"application/json","content-length":"218","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48058},"component":"security_audit","event_type":"security","event":"auth_success","timestamp":"2025-11-14T19:45:53.247Z","request_id":"e0e2edcc-999f-4269-957f-6113f575071e","ip":"::ffff:127.0.0.1","portfolio_id":"life-baef854f-51d2-47eb-8b3e-cded728e9c1d","mode":"access"}
{"level":30,"time":1763149553258,"pid":21124,"hostname":"i5-12600","req":{"id":"e0e2edcc-999f-4269-957f-6113f575071e","method":"POST","url":"/api/portfolio/life-baef854f-51d2-47eb-8b3e-cded728e9c1d","query":{},"params":{},"headers":{"host":"127.0.0.1:48057","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","x-portfolio-key-new":"[REDACTED]","content-type":"application/json","content-length":"218","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48058},"res":{"statusCode":200,"headers":{"x-request-id":"e0e2edcc-999f-4269-957f-6113f575071e","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"16","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"15","etag":"W/\"f-VaSQ4oDUiZblZNAEkkN+sX+q3Sg\""}},"responseTime":15,"msg":"request_complete"}
{"level":30,"time":1763149553270,"pid":21124,"hostname":"i5-12600","req":{"id":"402591c1-e967-4ebc-9e0f-85e8a506fde8","method":"GET","url":"/api/portfolio/life-baef854f-51d2-47eb-8b3e-cded728e9c1d","query":{},"params":{},"headers":{"host":"127.0.0.1:48059","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48060},"component":"security_audit","event_type":"security","event":"auth_failed","timestamp":"2025-11-14T19:45:53.269Z","request_id":"402591c1-e967-4ebc-9e0f-85e8a506fde8","ip":"::ffff:127.0.0.1","portfolio_id":"life-baef854f-51d2-47eb-8b3e-cded728e9c1d","reason":"invalid_key","blocked":false,"attempts":1,"remaining_attempts":4,"retry_after_seconds":null}
{"level":40,"time":1763149553271,"pid":21124,"hostname":"i5-12600","req":{"id":"402591c1-e967-4ebc-9e0f-85e8a506fde8","method":"GET","url":"/api/portfolio/life-baef854f-51d2-47eb-8b3e-cded728e9c1d","query":{},"params":{},"headers":{"host":"127.0.0.1:48059","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48060},"error":"Invalid portfolio key.","code":"INVALID_KEY","status":403,"msg":"request_error"}
{"level":30,"time":1763149553273,"pid":21124,"hostname":"i5-12600","req":{"id":"402591c1-e967-4ebc-9e0f-85e8a506fde8","method":"GET","url":"/api/portfolio/life-baef854f-51d2-47eb-8b3e-cded728e9c1d","query":{},"params":{},"headers":{"host":"127.0.0.1:48059","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48060},"res":{"statusCode":403,"headers":{"x-request-id":"402591c1-e967-4ebc-9e0f-85e8a506fde8","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"15","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"93","etag":"W/\"5d-z2XCAZDCVppYExLV+Xd2JNcJJPE\""}},"responseTime":8,"msg":"request_complete"}
{"level":30,"time":1763149553284,"pid":21124,"hostname":"i5-12600","req":{"id":"a188ff8e-53a7-4f9a-9e89-baae6b2fb405","method":"GET","url":"/api/portfolio/life-baef854f-51d2-47eb-8b3e-cded728e9c1d","query":{},"params":{},"headers":{"host":"127.0.0.1:48063","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48064},"component":"security_audit","event_type":"security","event":"auth_success","timestamp":"2025-11-14T19:45:53.284Z","request_id":"a188ff8e-53a7-4f9a-9e89-baae6b2fb405","ip":"::ffff:127.0.0.1","portfolio_id":"life-baef854f-51d2-47eb-8b3e-cded728e9c1d","mode":"access"}
{"level":30,"time":1763149553288,"pid":21124,"hostname":"i5-12600","req":{"id":"a188ff8e-53a7-4f9a-9e89-baae6b2fb405","method":"GET","url":"/api/portfolio/life-baef854f-51d2-47eb-8b3e-cded728e9c1d","query":{},"params":{},"headers":{"host":"127.0.0.1:48063","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48064},"res":{"statusCode":200,"headers":{"x-request-id":"a188ff8e-53a7-4f9a-9e89-baae6b2fb405","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"14","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"475","etag":"W/\"1db-YkkJc7Y3++UBZYoM+5JbdphSE5w\""}},"responseTime":6,"msg":"request_complete"}
✔ portfolio lifecycle persists transactions, signals, and key rotation (/api) (501.0327ms)
{"level":30,"time":1763149553538,"pid":21124,"hostname":"i5-12600","req":{"id":"inbound-trace","method":"POST","url":"/api/v1/portfolio/life-cb99214c-b978-4748-9fce-9484365077f2","query":{},"params":{},"headers":{"host":"127.0.0.1:48070","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","x-request-id":"inbound-trace","content-type":"application/json","content-length":"32","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48072},"component":"security_audit","event_type":"security","event":"auth_success","timestamp":"2025-11-14T19:45:53.538Z","request_id":"inbound-trace","ip":"::ffff:127.0.0.1","portfolio_id":"life-cb99214c-b978-4748-9fce-9484365077f2","mode":"bootstrap"}
{"level":30,"time":1763149553548,"pid":21124,"hostname":"i5-12600","req":{"id":"inbound-trace","method":"POST","url":"/api/v1/portfolio/life-cb99214c-b978-4748-9fce-9484365077f2","query":{},"params":{},"headers":{"host":"127.0.0.1:48070","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","x-request-id":"inbound-trace","content-type":"application/json","content-length":"32","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48072},"res":{"statusCode":200,"headers":{"x-request-id":"inbound-trace","x-api-version":"v1","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"19","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"15","etag":"W/\"f-VaSQ4oDUiZblZNAEkkN+sX+q3Sg\""}},"responseTime":230,"msg":"request_complete"}
{"level":30,"time":1763149553557,"pid":21124,"hostname":"i5-12600","req":{"id":"388ed9ef-cc83-4ae3-8874-5aa6fd595e36","method":"POST","url":"/api/v1/portfolio/life-cb99214c-b978-4748-9fce-9484365077f2","query":{},"params":{},"headers":{"host":"127.0.0.1:48077","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","content-type":"application/json","content-length":"218","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48078},"component":"security_audit","event_type":"security","event":"auth_success","timestamp":"2025-11-14T19:45:53.557Z","request_id":"388ed9ef-cc83-4ae3-8874-5aa6fd595e36","ip":"::ffff:127.0.0.1","portfolio_id":"life-cb99214c-b978-4748-9fce-9484365077f2","mode":"access"}
{"level":30,"time":1763149553568,"pid":21124,"hostname":"i5-12600","req":{"id":"388ed9ef-cc83-4ae3-8874-5aa6fd595e36","method":"POST","url":"/api/v1/portfolio/life-cb99214c-b978-4748-9fce-9484365077f2","query":{},"params":{},"headers":{"host":"127.0.0.1:48077","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","content-type":"application/json","content-length":"218","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48078},"res":{"statusCode":200,"headers":{"x-request-id":"388ed9ef-cc83-4ae3-8874-5aa6fd595e36","x-api-version":"v1","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"18","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"15","etag":"W/\"f-VaSQ4oDUiZblZNAEkkN+sX+q3Sg\""}},"responseTime":12,"msg":"request_complete"}
{"level":30,"time":1763149553575,"pid":21124,"hostname":"i5-12600","req":{"id":"13c75f0b-b4f6-403d-ba19-67a8c8555509","method":"GET","url":"/api/v1/portfolio/life-cb99214c-b978-4748-9fce-9484365077f2","query":{},"params":{},"headers":{"host":"127.0.0.1:48079","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48080},"component":"security_audit","event_type":"security","event":"auth_success","timestamp":"2025-11-14T19:45:53.575Z","request_id":"13c75f0b-b4f6-403d-ba19-67a8c8555509","ip":"::ffff:127.0.0.1","portfolio_id":"life-cb99214c-b978-4748-9fce-9484365077f2","mode":"access"}
{"level":30,"time":1763149553578,"pid":21124,"hostname":"i5-12600","req":{"id":"13c75f0b-b4f6-403d-ba19-67a8c8555509","method":"GET","url":"/api/v1/portfolio/life-cb99214c-b978-4748-9fce-9484365077f2","query":{},"params":{},"headers":{"host":"127.0.0.1:48079","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48080},"res":{"statusCode":200,"headers":{"x-request-id":"13c75f0b-b4f6-403d-ba19-67a8c8555509","x-api-version":"v1","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"17","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"475","etag":"W/\"1db-pH/OxPJNKrQKSFV065La1ZJ5+Ts\""}},"responseTime":4,"msg":"request_complete"}
{"level":30,"time":1763149553589,"pid":21124,"hostname":"i5-12600","req":{"id":"808b7818-7f45-4f8f-ad0d-78dd8ebfe86d","method":"POST","url":"/api/v1/portfolio/life-cb99214c-b978-4748-9fce-9484365077f2","query":{},"params":{},"headers":{"host":"127.0.0.1:48081","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","x-portfolio-key-new":"[REDACTED]","content-type":"application/json","content-length":"218","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48083},"component":"security_audit","event_type":"security","event":"key_rotated","timestamp":"2025-11-14T19:45:53.589Z","request_id":"808b7818-7f45-4f8f-ad0d-78dd8ebfe86d","ip":"::ffff:127.0.0.1","portfolio_id":"life-cb99214c-b978-4748-9fce-9484365077f2"}
{"level":30,"time":1763149553590,"pid":21124,"hostname":"i5-12600","req":{"id":"808b7818-7f45-4f8f-ad0d-78dd8ebfe86d","method":"POST","url":"/api/v1/portfolio/life-cb99214c-b978-4748-9fce-9484365077f2","query":{},"params":{},"headers":{"host":"127.0.0.1:48081","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","x-portfolio-key-new":"[REDACTED]","content-type":"application/json","content-length":"218","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48083},"component":"security_audit","event_type":"security","event":"auth_success","timestamp":"2025-11-14T19:45:53.590Z","request_id":"808b7818-7f45-4f8f-ad0d-78dd8ebfe86d","ip":"::ffff:127.0.0.1","portfolio_id":"life-cb99214c-b978-4748-9fce-9484365077f2","mode":"access"}
{"level":30,"time":1763149553598,"pid":21124,"hostname":"i5-12600","req":{"id":"808b7818-7f45-4f8f-ad0d-78dd8ebfe86d","method":"POST","url":"/api/v1/portfolio/life-cb99214c-b978-4748-9fce-9484365077f2","query":{},"params":{},"headers":{"host":"127.0.0.1:48081","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","x-portfolio-key-new":"[REDACTED]","content-type":"application/json","content-length":"218","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48083},"res":{"statusCode":200,"headers":{"x-request-id":"808b7818-7f45-4f8f-ad0d-78dd8ebfe86d","x-api-version":"v1","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"16","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"15","etag":"W/\"f-VaSQ4oDUiZblZNAEkkN+sX+q3Sg\""}},"responseTime":12,"msg":"request_complete"}
{"level":30,"time":1763149553604,"pid":21124,"hostname":"i5-12600","req":{"id":"dc427b2a-a5d7-4678-9c1c-75b2ad292942","method":"GET","url":"/api/v1/portfolio/life-cb99214c-b978-4748-9fce-9484365077f2","query":{},"params":{},"headers":{"host":"127.0.0.1:48089","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48090},"component":"security_audit","event_type":"security","event":"auth_failed","timestamp":"2025-11-14T19:45:53.604Z","request_id":"dc427b2a-a5d7-4678-9c1c-75b2ad292942","ip":"::ffff:127.0.0.1","portfolio_id":"life-cb99214c-b978-4748-9fce-9484365077f2","reason":"invalid_key","blocked":false,"attempts":1,"remaining_attempts":4,"retry_after_seconds":null}
{"level":40,"time":1763149553604,"pid":21124,"hostname":"i5-12600","req":{"id":"dc427b2a-a5d7-4678-9c1c-75b2ad292942","method":"GET","url":"/api/v1/portfolio/life-cb99214c-b978-4748-9fce-9484365077f2","query":{},"params":{},"headers":{"host":"127.0.0.1:48089","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48090},"error":"Invalid portfolio key.","code":"INVALID_KEY","status":403,"msg":"request_error"}
{"level":30,"time":1763149553604,"pid":21124,"hostname":"i5-12600","req":{"id":"dc427b2a-a5d7-4678-9c1c-75b2ad292942","method":"GET","url":"/api/v1/portfolio/life-cb99214c-b978-4748-9fce-9484365077f2","query":{},"params":{},"headers":{"host":"127.0.0.1:48089","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48090},"res":{"statusCode":403,"headers":{"x-request-id":"dc427b2a-a5d7-4678-9c1c-75b2ad292942","x-api-version":"v1","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"15","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"93","etag":"W/\"5d-z2XCAZDCVppYExLV+Xd2JNcJJPE\""}},"responseTime":1,"msg":"request_complete"}
{"level":30,"time":1763149553612,"pid":21124,"hostname":"i5-12600","req":{"id":"56b32b39-9811-4836-9d6e-2aac7d5c7379","method":"GET","url":"/api/v1/portfolio/life-cb99214c-b978-4748-9fce-9484365077f2","query":{},"params":{},"headers":{"host":"127.0.0.1:48091","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48092},"component":"security_audit","event_type":"security","event":"auth_success","timestamp":"2025-11-14T19:45:53.612Z","request_id":"56b32b39-9811-4836-9d6e-2aac7d5c7379","ip":"::ffff:127.0.0.1","portfolio_id":"life-cb99214c-b978-4748-9fce-9484365077f2","mode":"access"}
{"level":30,"time":1763149553614,"pid":21124,"hostname":"i5-12600","req":{"id":"56b32b39-9811-4836-9d6e-2aac7d5c7379","method":"GET","url":"/api/v1/portfolio/life-cb99214c-b978-4748-9fce-9484365077f2","query":{},"params":{},"headers":{"host":"127.0.0.1:48091","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48092},"res":{"statusCode":200,"headers":{"x-request-id":"56b32b39-9811-4836-9d6e-2aac7d5c7379","x-api-version":"v1","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"14","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"475","etag":"W/\"1db-UEdvDNnu65KUjWbzybxCtZVxxWo\""}},"responseTime":3,"msg":"request_complete"}
✔ portfolio lifecycle persists transactions, signals, and key rotation (/api/v1) (322.1735ms)
{"level":30,"time":1763149553951,"pid":21124,"hostname":"i5-12600","req":{"id":"493b6f45-9a7f-4cc3-9969-822eec582520","method":"POST","url":"/api/portfolio/con-6a7de1d4-726a-4b9e-8410-9ed4e47e15c3","query":{},"params":{},"headers":{"host":"127.0.0.1:48093","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","content-type":"application/json","content-length":"32","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48094},"component":"security_audit","event_type":"security","event":"auth_success","timestamp":"2025-11-14T19:45:53.951Z","request_id":"493b6f45-9a7f-4cc3-9969-822eec582520","ip":"::ffff:127.0.0.1","portfolio_id":"con-6a7de1d4-726a-4b9e-8410-9ed4e47e15c3","mode":"bootstrap"}
{"level":30,"time":1763149553973,"pid":21124,"hostname":"i5-12600","req":{"id":"493b6f45-9a7f-4cc3-9969-822eec582520","method":"POST","url":"/api/portfolio/con-6a7de1d4-726a-4b9e-8410-9ed4e47e15c3","query":{},"params":{},"headers":{"host":"127.0.0.1:48093","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","content-type":"application/json","content-length":"32","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48094},"res":{"statusCode":200,"headers":{"x-request-id":"493b6f45-9a7f-4cc3-9969-822eec582520","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"19","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"15","etag":"W/\"f-VaSQ4oDUiZblZNAEkkN+sX+q3Sg\""}},"responseTime":334,"msg":"request_complete"}
{"level":30,"time":1763149553983,"pid":21124,"hostname":"i5-12600","req":{"id":"7916594d-7907-4036-88e7-cb80e75cd890","method":"POST","url":"/api/portfolio/con-6a7de1d4-726a-4b9e-8410-9ed4e47e15c3","query":{},"params":{},"headers":{"host":"127.0.0.1:48101","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","content-type":"application/json","content-length":"174","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48103},"component":"security_audit","event_type":"security","event":"auth_success","timestamp":"2025-11-14T19:45:53.983Z","request_id":"7916594d-7907-4036-88e7-cb80e75cd890","ip":"::ffff:127.0.0.1","portfolio_id":"con-6a7de1d4-726a-4b9e-8410-9ed4e47e15c3","mode":"access"}
{"level":30,"time":1763149553985,"pid":21124,"hostname":"i5-12600","req":{"id":"536fb9d2-72af-45b0-b70c-9ba4c8f9765e","method":"POST","url":"/api/portfolio/con-6a7de1d4-726a-4b9e-8410-9ed4e47e15c3","query":{},"params":{},"headers":{"host":"127.0.0.1:48102","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","content-type":"application/json","content-length":"190","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48104},"component":"security_audit","event_type":"security","event":"auth_success","timestamp":"2025-11-14T19:45:53.985Z","request_id":"536fb9d2-72af-45b0-b70c-9ba4c8f9765e","ip":"::ffff:127.0.0.1","portfolio_id":"con-6a7de1d4-726a-4b9e-8410-9ed4e47e15c3","mode":"access"}
{"level":30,"time":1763149553999,"pid":21124,"hostname":"i5-12600","req":{"id":"7916594d-7907-4036-88e7-cb80e75cd890","method":"POST","url":"/api/portfolio/con-6a7de1d4-726a-4b9e-8410-9ed4e47e15c3","query":{},"params":{},"headers":{"host":"127.0.0.1:48101","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","content-type":"application/json","content-length":"174","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48103},"res":{"statusCode":200,"headers":{"x-request-id":"7916594d-7907-4036-88e7-cb80e75cd890","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"18","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"15","etag":"W/\"f-VaSQ4oDUiZblZNAEkkN+sX+q3Sg\""}},"responseTime":17,"msg":"request_complete"}
{"level":30,"time":1763149554010,"pid":21124,"hostname":"i5-12600","req":{"id":"536fb9d2-72af-45b0-b70c-9ba4c8f9765e","method":"POST","url":"/api/portfolio/con-6a7de1d4-726a-4b9e-8410-9ed4e47e15c3","query":{},"params":{},"headers":{"host":"127.0.0.1:48102","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","content-type":"application/json","content-length":"190","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48104},"res":{"statusCode":200,"headers":{"x-request-id":"536fb9d2-72af-45b0-b70c-9ba4c8f9765e","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"17","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"15","etag":"W/\"f-VaSQ4oDUiZblZNAEkkN+sX+q3Sg\""}},"responseTime":26,"msg":"request_complete"}
{"level":30,"time":1763149554018,"pid":21124,"hostname":"i5-12600","req":{"id":"366946bb-21b8-47de-8482-8b75cde45eca","method":"GET","url":"/api/portfolio/con-6a7de1d4-726a-4b9e-8410-9ed4e47e15c3","query":{},"params":{},"headers":{"host":"127.0.0.1:48105","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48106},"component":"security_audit","event_type":"security","event":"auth_success","timestamp":"2025-11-14T19:45:54.018Z","request_id":"366946bb-21b8-47de-8482-8b75cde45eca","ip":"::ffff:127.0.0.1","portfolio_id":"con-6a7de1d4-726a-4b9e-8410-9ed4e47e15c3","mode":"access"}
{"level":30,"time":1763149554021,"pid":21124,"hostname":"i5-12600","req":{"id":"366946bb-21b8-47de-8482-8b75cde45eca","method":"GET","url":"/api/portfolio/con-6a7de1d4-726a-4b9e-8410-9ed4e47e15c3","query":{},"params":{},"headers":{"host":"127.0.0.1:48105","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48106},"res":{"statusCode":200,"headers":{"x-request-id":"366946bb-21b8-47de-8482-8b75cde45eca","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"16","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"477","etag":"W/\"1dd-z9MsrivaKUnaXaF/XTuaHcnq0Po\""}},"responseTime":4,"msg":"request_complete"}
✔ concurrent portfolio modifications remain consistent (/api) (412.7361ms)
{"level":30,"time":1763149554488,"pid":21124,"hostname":"i5-12600","req":{"id":"129ad714-1988-4903-a264-6ff0c45342d4","method":"POST","url":"/api/v1/portfolio/con-d56c0534-8139-4fcf-9c01-3a7be5f898fa","query":{},"params":{},"headers":{"host":"127.0.0.1:48107","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","content-type":"application/json","content-length":"32","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48108},"component":"security_audit","event_type":"security","event":"auth_success","timestamp":"2025-11-14T19:45:54.488Z","request_id":"129ad714-1988-4903-a264-6ff0c45342d4","ip":"::ffff:127.0.0.1","portfolio_id":"con-d56c0534-8139-4fcf-9c01-3a7be5f898fa","mode":"bootstrap"}
{"level":30,"time":1763149554499,"pid":21124,"hostname":"i5-12600","req":{"id":"129ad714-1988-4903-a264-6ff0c45342d4","method":"POST","url":"/api/v1/portfolio/con-d56c0534-8139-4fcf-9c01-3a7be5f898fa","query":{},"params":{},"headers":{"host":"127.0.0.1:48107","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","content-type":"application/json","content-length":"32","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48108},"res":{"statusCode":200,"headers":{"x-request-id":"129ad714-1988-4903-a264-6ff0c45342d4","x-api-version":"v1","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"19","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"15","etag":"W/\"f-VaSQ4oDUiZblZNAEkkN+sX+q3Sg\""}},"responseTime":446,"msg":"request_complete"}
{"level":30,"time":1763149554508,"pid":21124,"hostname":"i5-12600","req":{"id":"082c507a-a389-4390-876a-e151488b50f9","method":"POST","url":"/api/v1/portfolio/con-d56c0534-8139-4fcf-9c01-3a7be5f898fa","query":{},"params":{},"headers":{"host":"127.0.0.1:48111","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","content-type":"application/json","content-length":"174","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48113},"component":"security_audit","event_type":"security","event":"auth_success","timestamp":"2025-11-14T19:45:54.508Z","request_id":"082c507a-a389-4390-876a-e151488b50f9","ip":"::ffff:127.0.0.1","portfolio_id":"con-d56c0534-8139-4fcf-9c01-3a7be5f898fa","mode":"access"}
{"level":30,"time":1763149554510,"pid":21124,"hostname":"i5-12600","req":{"id":"f0fa3afc-e5dd-4887-8a4d-5f009fa2a66b","method":"POST","url":"/api/v1/portfolio/con-d56c0534-8139-4fcf-9c01-3a7be5f898fa","query":{},"params":{},"headers":{"host":"127.0.0.1:48112","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","content-type":"application/json","content-length":"190","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48114},"component":"security_audit","event_type":"security","event":"auth_success","timestamp":"2025-11-14T19:45:54.510Z","request_id":"f0fa3afc-e5dd-4887-8a4d-5f009fa2a66b","ip":"::ffff:127.0.0.1","portfolio_id":"con-d56c0534-8139-4fcf-9c01-3a7be5f898fa","mode":"access"}
{"level":30,"time":1763149554519,"pid":21124,"hostname":"i5-12600","req":{"id":"082c507a-a389-4390-876a-e151488b50f9","method":"POST","url":"/api/v1/portfolio/con-d56c0534-8139-4fcf-9c01-3a7be5f898fa","query":{},"params":{},"headers":{"host":"127.0.0.1:48111","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","content-type":"application/json","content-length":"174","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48113},"res":{"statusCode":200,"headers":{"x-request-id":"082c507a-a389-4390-876a-e151488b50f9","x-api-version":"v1","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"18","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"15","etag":"W/\"f-VaSQ4oDUiZblZNAEkkN+sX+q3Sg\""}},"responseTime":12,"msg":"request_complete"}
{"level":30,"time":1763149554528,"pid":21124,"hostname":"i5-12600","req":{"id":"f0fa3afc-e5dd-4887-8a4d-5f009fa2a66b","method":"POST","url":"/api/v1/portfolio/con-d56c0534-8139-4fcf-9c01-3a7be5f898fa","query":{},"params":{},"headers":{"host":"127.0.0.1:48112","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","content-type":"application/json","content-length":"190","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48114},"res":{"statusCode":200,"headers":{"x-request-id":"f0fa3afc-e5dd-4887-8a4d-5f009fa2a66b","x-api-version":"v1","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"17","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"15","etag":"W/\"f-VaSQ4oDUiZblZNAEkkN+sX+q3Sg\""}},"responseTime":19,"msg":"request_complete"}
{"level":30,"time":1763149554534,"pid":21124,"hostname":"i5-12600","req":{"id":"bd9dd20b-c4b2-40ef-92dd-dadb663ffdca","method":"GET","url":"/api/v1/portfolio/con-d56c0534-8139-4fcf-9c01-3a7be5f898fa","query":{},"params":{},"headers":{"host":"127.0.0.1:48118","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48119},"component":"security_audit","event_type":"security","event":"auth_success","timestamp":"2025-11-14T19:45:54.534Z","request_id":"bd9dd20b-c4b2-40ef-92dd-dadb663ffdca","ip":"::ffff:127.0.0.1","portfolio_id":"con-d56c0534-8139-4fcf-9c01-3a7be5f898fa","mode":"access"}
{"level":30,"time":1763149554540,"pid":21124,"hostname":"i5-12600","req":{"id":"bd9dd20b-c4b2-40ef-92dd-dadb663ffdca","method":"GET","url":"/api/v1/portfolio/con-d56c0534-8139-4fcf-9c01-3a7be5f898fa","query":{},"params":{},"headers":{"host":"127.0.0.1:48118","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48119},"res":{"statusCode":200,"headers":{"x-request-id":"bd9dd20b-c4b2-40ef-92dd-dadb663ffdca","x-api-version":"v1","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"16","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"477","etag":"W/\"1dd-2566MRp7LQpEx2fHPqBSflhSJog\""}},"responseTime":7,"msg":"request_complete"}
✔ concurrent portfolio modifications remain consistent (/api/v1) (511.6859ms)
{"level":30,"time":1763149554810,"pid":21124,"hostname":"i5-12600","req":{"id":"fd5dd16b-a196-408d-9d3f-a175746df790","method":"POST","url":"/api/portfolio/bf-be807fc1-c2ec-4850-9c91-9b45822f74ff","query":{},"params":{},"headers":{"host":"127.0.0.1:48121","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","content-type":"application/json","content-length":"32","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48122},"component":"security_audit","event_type":"security","event":"auth_success","timestamp":"2025-11-14T19:45:54.810Z","request_id":"fd5dd16b-a196-408d-9d3f-a175746df790","ip":"::ffff:127.0.0.1","portfolio_id":"bf-be807fc1-c2ec-4850-9c91-9b45822f74ff","mode":"bootstrap"}
{"level":30,"time":1763149554819,"pid":21124,"hostname":"i5-12600","req":{"id":"fd5dd16b-a196-408d-9d3f-a175746df790","method":"POST","url":"/api/portfolio/bf-be807fc1-c2ec-4850-9c91-9b45822f74ff","query":{},"params":{},"headers":{"host":"127.0.0.1:48121","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","content-type":"application/json","content-length":"32","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48122},"res":{"statusCode":200,"headers":{"x-request-id":"fd5dd16b-a196-408d-9d3f-a175746df790","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"19","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"15","etag":"W/\"f-VaSQ4oDUiZblZNAEkkN+sX+q3Sg\""}},"responseTime":256,"msg":"request_complete"}
{"level":30,"time":1763149554825,"pid":21124,"hostname":"i5-12600","req":{"id":"b7f7a937-fd37-4558-85bc-73864bf6f40d","method":"GET","url":"/api/portfolio/bf-be807fc1-c2ec-4850-9c91-9b45822f74ff","query":{},"params":{},"headers":{"host":"127.0.0.1:48125","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48126},"component":"security_audit","event_type":"security","event":"auth_failed","timestamp":"2025-11-14T19:45:54.825Z","request_id":"b7f7a937-fd37-4558-85bc-73864bf6f40d","ip":"::ffff:127.0.0.1","portfolio_id":"bf-be807fc1-c2ec-4850-9c91-9b45822f74ff","reason":"invalid_key","blocked":false,"attempts":1,"remaining_attempts":4,"retry_after_seconds":null}
{"level":40,"time":1763149554825,"pid":21124,"hostname":"i5-12600","req":{"id":"b7f7a937-fd37-4558-85bc-73864bf6f40d","method":"GET","url":"/api/portfolio/bf-be807fc1-c2ec-4850-9c91-9b45822f74ff","query":{},"params":{},"headers":{"host":"127.0.0.1:48125","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48126},"error":"Invalid portfolio key.","code":"INVALID_KEY","status":403,"msg":"request_error"}
{"level":30,"time":1763149554827,"pid":21124,"hostname":"i5-12600","req":{"id":"b7f7a937-fd37-4558-85bc-73864bf6f40d","method":"GET","url":"/api/portfolio/bf-be807fc1-c2ec-4850-9c91-9b45822f74ff","query":{},"params":{},"headers":{"host":"127.0.0.1:48125","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48126},"res":{"statusCode":403,"headers":{"x-request-id":"b7f7a937-fd37-4558-85bc-73864bf6f40d","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"18","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"93","etag":"W/\"5d-z2XCAZDCVppYExLV+Xd2JNcJJPE\""}},"responseTime":3,"msg":"request_complete"}
{"level":30,"time":1763149554833,"pid":21124,"hostname":"i5-12600","req":{"id":"0f935553-6845-476f-b33f-407aaaf8b3d3","method":"GET","url":"/api/portfolio/bf-be807fc1-c2ec-4850-9c91-9b45822f74ff","query":{},"params":{},"headers":{"host":"127.0.0.1:48127","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48128},"component":"security_audit","event_type":"security","event":"auth_failed","timestamp":"2025-11-14T19:45:54.833Z","request_id":"0f935553-6845-476f-b33f-407aaaf8b3d3","ip":"::ffff:127.0.0.1","portfolio_id":"bf-be807fc1-c2ec-4850-9c91-9b45822f74ff","reason":"invalid_key","blocked":false,"attempts":2,"remaining_attempts":3,"retry_after_seconds":null}
{"level":40,"time":1763149554833,"pid":21124,"hostname":"i5-12600","req":{"id":"0f935553-6845-476f-b33f-407aaaf8b3d3","method":"GET","url":"/api/portfolio/bf-be807fc1-c2ec-4850-9c91-9b45822f74ff","query":{},"params":{},"headers":{"host":"127.0.0.1:48127","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48128},"error":"Invalid portfolio key.","code":"INVALID_KEY","status":403,"msg":"request_error"}
{"level":30,"time":1763149554834,"pid":21124,"hostname":"i5-12600","req":{"id":"0f935553-6845-476f-b33f-407aaaf8b3d3","method":"GET","url":"/api/portfolio/bf-be807fc1-c2ec-4850-9c91-9b45822f74ff","query":{},"params":{},"headers":{"host":"127.0.0.1:48127","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48128},"res":{"statusCode":403,"headers":{"x-request-id":"0f935553-6845-476f-b33f-407aaaf8b3d3","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"17","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"93","etag":"W/\"5d-oEJXqU1tUkCC1TuzUM/dMhqECRM\""}},"responseTime":2,"msg":"request_complete"}
{"level":30,"time":1763149554842,"pid":21124,"hostname":"i5-12600","req":{"id":"0666f092-9231-4219-ba8a-e3a2a95c9af6","method":"GET","url":"/api/portfolio/bf-be807fc1-c2ec-4850-9c91-9b45822f74ff","query":{},"params":{},"headers":{"host":"127.0.0.1:48129","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48130},"component":"security_audit","event_type":"security","event":"auth_failed","timestamp":"2025-11-14T19:45:54.842Z","request_id":"0666f092-9231-4219-ba8a-e3a2a95c9af6","ip":"::ffff:127.0.0.1","portfolio_id":"bf-be807fc1-c2ec-4850-9c91-9b45822f74ff","reason":"invalid_key","blocked":false,"attempts":3,"remaining_attempts":2,"retry_after_seconds":null}
{"level":40,"time":1763149554842,"pid":21124,"hostname":"i5-12600","req":{"id":"0666f092-9231-4219-ba8a-e3a2a95c9af6","method":"GET","url":"/api/portfolio/bf-be807fc1-c2ec-4850-9c91-9b45822f74ff","query":{},"params":{},"headers":{"host":"127.0.0.1:48129","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48130},"error":"Invalid portfolio key.","code":"INVALID_KEY","status":403,"msg":"request_error"}
{"level":30,"time":1763149554843,"pid":21124,"hostname":"i5-12600","req":{"id":"0666f092-9231-4219-ba8a-e3a2a95c9af6","method":"GET","url":"/api/portfolio/bf-be807fc1-c2ec-4850-9c91-9b45822f74ff","query":{},"params":{},"headers":{"host":"127.0.0.1:48129","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48130},"res":{"statusCode":403,"headers":{"x-request-id":"0666f092-9231-4219-ba8a-e3a2a95c9af6","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"16","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"93","etag":"W/\"5d-ELcfWRGClygcgbKqalSEh8giJgw\""}},"responseTime":2,"msg":"request_complete"}
{"level":30,"time":1763149554848,"pid":21124,"hostname":"i5-12600","req":{"id":"26f7e228-8e6d-4fc5-95fe-0f8e55313aab","method":"GET","url":"/api/portfolio/bf-be807fc1-c2ec-4850-9c91-9b45822f74ff","query":{},"params":{},"headers":{"host":"127.0.0.1:48131","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48132},"component":"security_audit","event_type":"security","event":"auth_failed","timestamp":"2025-11-14T19:45:54.848Z","request_id":"26f7e228-8e6d-4fc5-95fe-0f8e55313aab","ip":"::ffff:127.0.0.1","portfolio_id":"bf-be807fc1-c2ec-4850-9c91-9b45822f74ff","reason":"invalid_key","blocked":false,"attempts":4,"remaining_attempts":1,"retry_after_seconds":null}
{"level":40,"time":1763149554849,"pid":21124,"hostname":"i5-12600","req":{"id":"26f7e228-8e6d-4fc5-95fe-0f8e55313aab","method":"GET","url":"/api/portfolio/bf-be807fc1-c2ec-4850-9c91-9b45822f74ff","query":{},"params":{},"headers":{"host":"127.0.0.1:48131","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48132},"error":"Invalid portfolio key.","code":"INVALID_KEY","status":403,"msg":"request_error"}
{"level":30,"time":1763149554849,"pid":21124,"hostname":"i5-12600","req":{"id":"26f7e228-8e6d-4fc5-95fe-0f8e55313aab","method":"GET","url":"/api/portfolio/bf-be807fc1-c2ec-4850-9c91-9b45822f74ff","query":{},"params":{},"headers":{"host":"127.0.0.1:48131","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48132},"res":{"statusCode":403,"headers":{"x-request-id":"26f7e228-8e6d-4fc5-95fe-0f8e55313aab","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"15","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"93","etag":"W/\"5d-RTDrvLGkJFk4Wf6g751GoYZliLE\""}},"responseTime":1,"msg":"request_complete"}
{"level":30,"time":1763149554856,"pid":21124,"hostname":"i5-12600","req":{"id":"230b0e9b-c016-41c2-8a7d-41dc51c8ed89","method":"GET","url":"/api/portfolio/bf-be807fc1-c2ec-4850-9c91-9b45822f74ff","query":{},"params":{},"headers":{"host":"127.0.0.1:48133","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48134},"component":"security_audit","event_type":"security","event":"auth_failed","timestamp":"2025-11-14T19:45:54.856Z","request_id":"230b0e9b-c016-41c2-8a7d-41dc51c8ed89","ip":"::ffff:127.0.0.1","portfolio_id":"bf-be807fc1-c2ec-4850-9c91-9b45822f74ff","reason":"invalid_key","blocked":true,"attempts":5,"remaining_attempts":null,"retry_after_seconds":2}
{"level":40,"time":1763149554857,"pid":21124,"hostname":"i5-12600","req":{"id":"230b0e9b-c016-41c2-8a7d-41dc51c8ed89","method":"GET","url":"/api/portfolio/bf-be807fc1-c2ec-4850-9c91-9b45822f74ff","query":{},"params":{},"headers":{"host":"127.0.0.1:48133","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48134},"error":"Too many invalid portfolio key attempts. Try again later.","code":"TOO_MANY_KEY_ATTEMPTS","status":429,"msg":"request_error"}
{"level":30,"time":1763149554858,"pid":21124,"hostname":"i5-12600","req":{"id":"230b0e9b-c016-41c2-8a7d-41dc51c8ed89","method":"GET","url":"/api/portfolio/bf-be807fc1-c2ec-4850-9c91-9b45822f74ff","query":{},"params":{},"headers":{"host":"127.0.0.1:48133","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48134},"res":{"statusCode":429,"headers":{"x-request-id":"230b0e9b-c016-41c2-8a7d-41dc51c8ed89","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"14","ratelimit-reset":"60","retry-after":"2","content-type":"application/json; charset=utf-8","content-length":"103","etag":"W/\"67-I3qYWO1Ta4yFxmvaMkJJHkDFSp4\""}},"responseTime":4,"msg":"request_complete"}
{"level":30,"time":1763149556977,"pid":21124,"hostname":"i5-12600","req":{"id":"f4b9b58c-c77f-494a-a065-e08f950eb31c","method":"GET","url":"/api/portfolio/bf-be807fc1-c2ec-4850-9c91-9b45822f74ff","query":{},"params":{},"headers":{"host":"127.0.0.1:48247","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48248},"component":"security_audit","event_type":"security","event":"auth_success","timestamp":"2025-11-14T19:45:56.977Z","request_id":"f4b9b58c-c77f-494a-a065-e08f950eb31c","ip":"::ffff:127.0.0.1","portfolio_id":"bf-be807fc1-c2ec-4850-9c91-9b45822f74ff","mode":"access"}
{"level":30,"time":1763149556978,"pid":21124,"hostname":"i5-12600","req":{"id":"f4b9b58c-c77f-494a-a065-e08f950eb31c","method":"GET","url":"/api/portfolio/bf-be807fc1-c2ec-4850-9c91-9b45822f74ff","query":{},"params":{},"headers":{"host":"127.0.0.1:48247","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48248},"res":{"statusCode":200,"headers":{"x-request-id":"f4b9b58c-c77f-494a-a065-e08f950eb31c","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"13","ratelimit-reset":"58","content-type":"application/json; charset=utf-8","content-length":"135","etag":"W/\"87-rKvhb1l54tIElzSP2SLCMvrkOBA\""}},"responseTime":2,"msg":"request_complete"}
✔ brute-force guard blocks repeated invalid key attempts and allows recovery (/api) (2431.0561ms)
{"level":30,"time":1763149557140,"pid":21124,"hostname":"i5-12600","req":{"id":"c67a08f6-9f72-4935-bf10-547d01150d61","method":"POST","url":"/api/v1/portfolio/bf-30417f1a-9ff5-4a27-8c51-f6f5f96a7792","query":{},"params":{},"headers":{"host":"127.0.0.1:48249","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","content-type":"application/json","content-length":"32","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48250},"component":"security_audit","event_type":"security","event":"auth_success","timestamp":"2025-11-14T19:45:57.140Z","request_id":"c67a08f6-9f72-4935-bf10-547d01150d61","ip":"::ffff:127.0.0.1","portfolio_id":"bf-30417f1a-9ff5-4a27-8c51-f6f5f96a7792","mode":"bootstrap"}
{"level":30,"time":1763149557146,"pid":21124,"hostname":"i5-12600","req":{"id":"c67a08f6-9f72-4935-bf10-547d01150d61","method":"POST","url":"/api/v1/portfolio/bf-30417f1a-9ff5-4a27-8c51-f6f5f96a7792","query":{},"params":{},"headers":{"host":"127.0.0.1:48249","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","content-type":"application/json","content-length":"32","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48250},"res":{"statusCode":200,"headers":{"x-request-id":"c67a08f6-9f72-4935-bf10-547d01150d61","x-api-version":"v1","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"19","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"15","etag":"W/\"f-VaSQ4oDUiZblZNAEkkN+sX+q3Sg\""}},"responseTime":150,"msg":"request_complete"}
{"level":30,"time":1763149557149,"pid":21124,"hostname":"i5-12600","req":{"id":"6a30b0cd-e8f1-424d-a2ab-92d829498bfd","method":"GET","url":"/api/v1/portfolio/bf-30417f1a-9ff5-4a27-8c51-f6f5f96a7792","query":{},"params":{},"headers":{"host":"127.0.0.1:48255","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48256},"component":"security_audit","event_type":"security","event":"auth_failed","timestamp":"2025-11-14T19:45:57.149Z","request_id":"6a30b0cd-e8f1-424d-a2ab-92d829498bfd","ip":"::ffff:127.0.0.1","portfolio_id":"bf-30417f1a-9ff5-4a27-8c51-f6f5f96a7792","reason":"invalid_key","blocked":false,"attempts":1,"remaining_attempts":4,"retry_after_seconds":null}
{"level":40,"time":1763149557149,"pid":21124,"hostname":"i5-12600","req":{"id":"6a30b0cd-e8f1-424d-a2ab-92d829498bfd","method":"GET","url":"/api/v1/portfolio/bf-30417f1a-9ff5-4a27-8c51-f6f5f96a7792","query":{},"params":{},"headers":{"host":"127.0.0.1:48255","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48256},"error":"Invalid portfolio key.","code":"INVALID_KEY","status":403,"msg":"request_error"}
{"level":30,"time":1763149557150,"pid":21124,"hostname":"i5-12600","req":{"id":"6a30b0cd-e8f1-424d-a2ab-92d829498bfd","method":"GET","url":"/api/v1/portfolio/bf-30417f1a-9ff5-4a27-8c51-f6f5f96a7792","query":{},"params":{},"headers":{"host":"127.0.0.1:48255","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48256},"res":{"statusCode":403,"headers":{"x-request-id":"6a30b0cd-e8f1-424d-a2ab-92d829498bfd","x-api-version":"v1","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"18","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"93","etag":"W/\"5d-z2XCAZDCVppYExLV+Xd2JNcJJPE\""}},"responseTime":1,"msg":"request_complete"}
{"level":30,"time":1763149557152,"pid":21124,"hostname":"i5-12600","req":{"id":"f29f5f76-38c6-45fa-988a-a22ed72ce1c1","method":"GET","url":"/api/v1/portfolio/bf-30417f1a-9ff5-4a27-8c51-f6f5f96a7792","query":{},"params":{},"headers":{"host":"127.0.0.1:48257","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48258},"component":"security_audit","event_type":"security","event":"auth_failed","timestamp":"2025-11-14T19:45:57.152Z","request_id":"f29f5f76-38c6-45fa-988a-a22ed72ce1c1","ip":"::ffff:127.0.0.1","portfolio_id":"bf-30417f1a-9ff5-4a27-8c51-f6f5f96a7792","reason":"invalid_key","blocked":false,"attempts":2,"remaining_attempts":3,"retry_after_seconds":null}
{"level":40,"time":1763149557152,"pid":21124,"hostname":"i5-12600","req":{"id":"f29f5f76-38c6-45fa-988a-a22ed72ce1c1","method":"GET","url":"/api/v1/portfolio/bf-30417f1a-9ff5-4a27-8c51-f6f5f96a7792","query":{},"params":{},"headers":{"host":"127.0.0.1:48257","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48258},"error":"Invalid portfolio key.","code":"INVALID_KEY","status":403,"msg":"request_error"}
{"level":30,"time":1763149557153,"pid":21124,"hostname":"i5-12600","req":{"id":"f29f5f76-38c6-45fa-988a-a22ed72ce1c1","method":"GET","url":"/api/v1/portfolio/bf-30417f1a-9ff5-4a27-8c51-f6f5f96a7792","query":{},"params":{},"headers":{"host":"127.0.0.1:48257","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48258},"res":{"statusCode":403,"headers":{"x-request-id":"f29f5f76-38c6-45fa-988a-a22ed72ce1c1","x-api-version":"v1","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"17","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"93","etag":"W/\"5d-oEJXqU1tUkCC1TuzUM/dMhqECRM\""}},"responseTime":1,"msg":"request_complete"}
{"level":30,"time":1763149557155,"pid":21124,"hostname":"i5-12600","req":{"id":"504ea946-190b-4eb1-94f2-46ae5f89f786","method":"GET","url":"/api/v1/portfolio/bf-30417f1a-9ff5-4a27-8c51-f6f5f96a7792","query":{},"params":{},"headers":{"host":"127.0.0.1:48259","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48260},"component":"security_audit","event_type":"security","event":"auth_failed","timestamp":"2025-11-14T19:45:57.155Z","request_id":"504ea946-190b-4eb1-94f2-46ae5f89f786","ip":"::ffff:127.0.0.1","portfolio_id":"bf-30417f1a-9ff5-4a27-8c51-f6f5f96a7792","reason":"invalid_key","blocked":false,"attempts":3,"remaining_attempts":2,"retry_after_seconds":null}
{"level":40,"time":1763149557156,"pid":21124,"hostname":"i5-12600","req":{"id":"504ea946-190b-4eb1-94f2-46ae5f89f786","method":"GET","url":"/api/v1/portfolio/bf-30417f1a-9ff5-4a27-8c51-f6f5f96a7792","query":{},"params":{},"headers":{"host":"127.0.0.1:48259","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48260},"error":"Invalid portfolio key.","code":"INVALID_KEY","status":403,"msg":"request_error"}
{"level":30,"time":1763149557156,"pid":21124,"hostname":"i5-12600","req":{"id":"504ea946-190b-4eb1-94f2-46ae5f89f786","method":"GET","url":"/api/v1/portfolio/bf-30417f1a-9ff5-4a27-8c51-f6f5f96a7792","query":{},"params":{},"headers":{"host":"127.0.0.1:48259","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48260},"res":{"statusCode":403,"headers":{"x-request-id":"504ea946-190b-4eb1-94f2-46ae5f89f786","x-api-version":"v1","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"16","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"93","etag":"W/\"5d-ELcfWRGClygcgbKqalSEh8giJgw\""}},"responseTime":1,"msg":"request_complete"}
{"level":30,"time":1763149557159,"pid":21124,"hostname":"i5-12600","req":{"id":"924ff937-c881-45a8-a078-8d0536662e23","method":"GET","url":"/api/v1/portfolio/bf-30417f1a-9ff5-4a27-8c51-f6f5f96a7792","query":{},"params":{},"headers":{"host":"127.0.0.1:48261","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48262},"component":"security_audit","event_type":"security","event":"auth_failed","timestamp":"2025-11-14T19:45:57.159Z","request_id":"924ff937-c881-45a8-a078-8d0536662e23","ip":"::ffff:127.0.0.1","portfolio_id":"bf-30417f1a-9ff5-4a27-8c51-f6f5f96a7792","reason":"invalid_key","blocked":false,"attempts":4,"remaining_attempts":1,"retry_after_seconds":null}
{"level":40,"time":1763149557159,"pid":21124,"hostname":"i5-12600","req":{"id":"924ff937-c881-45a8-a078-8d0536662e23","method":"GET","url":"/api/v1/portfolio/bf-30417f1a-9ff5-4a27-8c51-f6f5f96a7792","query":{},"params":{},"headers":{"host":"127.0.0.1:48261","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48262},"error":"Invalid portfolio key.","code":"INVALID_KEY","status":403,"msg":"request_error"}
{"level":30,"time":1763149557159,"pid":21124,"hostname":"i5-12600","req":{"id":"924ff937-c881-45a8-a078-8d0536662e23","method":"GET","url":"/api/v1/portfolio/bf-30417f1a-9ff5-4a27-8c51-f6f5f96a7792","query":{},"params":{},"headers":{"host":"127.0.0.1:48261","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48262},"res":{"statusCode":403,"headers":{"x-request-id":"924ff937-c881-45a8-a078-8d0536662e23","x-api-version":"v1","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"15","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","content-length":"93","etag":"W/\"5d-RTDrvLGkJFk4Wf6g751GoYZliLE\""}},"responseTime":1,"msg":"request_complete"}
{"level":30,"time":1763149557162,"pid":21124,"hostname":"i5-12600","req":{"id":"bc62f83c-1edf-4044-a218-25a8581fb105","method":"GET","url":"/api/v1/portfolio/bf-30417f1a-9ff5-4a27-8c51-f6f5f96a7792","query":{},"params":{},"headers":{"host":"127.0.0.1:48263","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48264},"component":"security_audit","event_type":"security","event":"auth_failed","timestamp":"2025-11-14T19:45:57.162Z","request_id":"bc62f83c-1edf-4044-a218-25a8581fb105","ip":"::ffff:127.0.0.1","portfolio_id":"bf-30417f1a-9ff5-4a27-8c51-f6f5f96a7792","reason":"invalid_key","blocked":true,"attempts":5,"remaining_attempts":null,"retry_after_seconds":2}
{"level":40,"time":1763149557162,"pid":21124,"hostname":"i5-12600","req":{"id":"bc62f83c-1edf-4044-a218-25a8581fb105","method":"GET","url":"/api/v1/portfolio/bf-30417f1a-9ff5-4a27-8c51-f6f5f96a7792","query":{},"params":{},"headers":{"host":"127.0.0.1:48263","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48264},"error":"Too many invalid portfolio key attempts. Try again later.","code":"TOO_MANY_KEY_ATTEMPTS","status":429,"msg":"request_error"}
{"level":30,"time":1763149557162,"pid":21124,"hostname":"i5-12600","req":{"id":"bc62f83c-1edf-4044-a218-25a8581fb105","method":"GET","url":"/api/v1/portfolio/bf-30417f1a-9ff5-4a27-8c51-f6f5f96a7792","query":{},"params":{},"headers":{"host":"127.0.0.1:48263","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48264},"res":{"statusCode":429,"headers":{"x-request-id":"bc62f83c-1edf-4044-a218-25a8581fb105","x-api-version":"v1","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"14","ratelimit-reset":"60","retry-after":"2","content-type":"application/json; charset=utf-8","content-length":"103","etag":"W/\"67-I3qYWO1Ta4yFxmvaMkJJHkDFSp4\""}},"responseTime":1,"msg":"request_complete"}
{"level":30,"time":1763149559267,"pid":21124,"hostname":"i5-12600","req":{"id":"35d5ee9d-2d65-49b0-b21c-77566a5d34fe","method":"GET","url":"/api/v1/portfolio/bf-30417f1a-9ff5-4a27-8c51-f6f5f96a7792","query":{},"params":{},"headers":{"host":"127.0.0.1:48265","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48266},"component":"security_audit","event_type":"security","event":"auth_success","timestamp":"2025-11-14T19:45:59.267Z","request_id":"35d5ee9d-2d65-49b0-b21c-77566a5d34fe","ip":"::ffff:127.0.0.1","portfolio_id":"bf-30417f1a-9ff5-4a27-8c51-f6f5f96a7792","mode":"access"}
{"level":30,"time":1763149559269,"pid":21124,"hostname":"i5-12600","req":{"id":"35d5ee9d-2d65-49b0-b21c-77566a5d34fe","method":"GET","url":"/api/v1/portfolio/bf-30417f1a-9ff5-4a27-8c51-f6f5f96a7792","query":{},"params":{},"headers":{"host":"127.0.0.1:48265","accept-encoding":"gzip, deflate","x-portfolio-key":"[REDACTED]","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48266},"res":{"statusCode":200,"headers":{"x-request-id":"35d5ee9d-2d65-49b0-b21c-77566a5d34fe","x-api-version":"v1","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"20;w=60","ratelimit-limit":"20","ratelimit-remaining":"13","ratelimit-reset":"58","content-type":"application/json; charset=utf-8","content-length":"135","etag":"W/\"87-rKvhb1l54tIElzSP2SLCMvrkOBA\""}},"responseTime":2,"msg":"request_complete"}
✔ brute-force guard blocks repeated invalid key attempts and allows recovery (/api/v1) (2287.5217ms)
{"level":30,"time":1763149559280,"pid":21124,"hostname":"i5-12600","req":{"id":"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx","method":"GET","url":"/api/monitoring","query":{},"params":{},"headers":{"host":"127.0.0.1:48267","accept-encoding":"gzip, deflate","x-request-id":"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48268},"res":{"statusCode":200,"headers":{"x-request-id":"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"100;w=60","ratelimit-limit":"100","ratelimit-remaining":"99","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","etag":"W/\"469-UdhbRxpn7/7LU+HJmJ0pqKECr4E\"","content-encoding":"gzip"}},"responseTime":2,"msg":"request_complete"}
✔ incoming request id header is normalized and echoed (/api) (7.4839ms)
{"level":30,"time":1763149559286,"pid":21124,"hostname":"i5-12600","req":{"id":"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx","method":"GET","url":"/api/v1/monitoring","query":{},"params":{},"headers":{"host":"127.0.0.1:48269","accept-encoding":"gzip, deflate","x-request-id":"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48270},"res":{"statusCode":200,"headers":{"x-request-id":"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx","x-api-version":"v1","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"100;w=60","ratelimit-limit":"100","ratelimit-remaining":"99","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","etag":"W/\"46a-TSi8Q0rCkv/nihb7H8EbwtlmDF4\"","content-encoding":"gzip"}},"responseTime":1,"msg":"request_complete"}
✔ incoming request id header is normalized and echoed (/api/v1) (6.3214ms)
✔ ledger transactions preserve invariants under random scenarios (341.3062ms)
✖ portfolio migration seeds cash policy and backups original file (286.0906ms)
✔ portfolio cash policy migration is idempotent (5430.9087ms)
{"level":30,"time":1763149553765,"pid":32124,"hostname":"i5-12600","req":{"id":"d4550aaf-c8d3-4b15-9695-022e78b97539","method":"GET","url":"/api/monitoring","query":{},"params":{},"headers":{"host":"127.0.0.1:48095","accept-encoding":"gzip, deflate","connection":"close"},"remoteAddress":"::ffff:127.0.0.1","remotePort":48096},"res":{"statusCode":200,"headers":{"x-request-id":"d4550aaf-c8d3-4b15-9695-022e78b97539","warning":"299 - \"Legacy API path /api is deprecated; migrate to /api/v1\"","x-api-version":"legacy","content-security-policy":"default-src 'self';base-uri 'self';script-src 'self';frame-ancestors 'none';connect-src 'self';font-src 'self' https: data:;form-action 'self';img-src 'self' data:;object-src 'none';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests","cross-origin-opener-policy":"same-origin","cross-origin-resource-policy":"same-origin","origin-agent-cluster":"?1","referrer-policy":"no-referrer","strict-transport-security":"max-age=15552000; includeSubDomains; preload","x-content-type-options":"nosniff","x-dns-prefetch-control":"off","x-download-options":"noopen","x-frame-options":"DENY","x-permitted-cross-domain-policies":"none","x-xss-protection":"0","vary":"Origin, Accept-Encoding","ratelimit-policy":"100;w=60","ratelimit-limit":"100","ratelimit-remaining":"99","ratelimit-reset":"60","content-type":"application/json; charset=utf-8","etag":"W/\"46b-X/Lo1+egFmCwsEsVI+66qKwZ25M\"","content-encoding":"gzip"}},"responseTime":38,"msg":"request_complete"}
▶ performance monitoring endpoint
  ✔ reports runtime, cache, lock, and security metrics (113.0238ms)
  ✔ getPerformanceMetrics exposes deterministic structure (5.2865ms)
✔ performance monitoring endpoint (120.3754ms)
